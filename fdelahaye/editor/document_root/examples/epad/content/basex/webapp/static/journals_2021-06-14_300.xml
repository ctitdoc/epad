<journals>
<issue_66730>
<issue_url>https://redmine.bilendi.com/issues/66730</issue_url>
</issue_66730>
<issue_66729>
<issue_url>https://redmine.bilendi.com/issues/66729</issue_url>
</issue_66729>
<issue_66689>
<issue_url>https://redmine.bilendi.com/issues/66689</issue_url>
</issue_66689>
<issue_66686>
<issue_url>https://redmine.bilendi.com/issues/66686</issue_url>
<journal id="639354">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-14T13:19:41Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>8</old_value>
      <new_value>2</new_value>
    </detail>
    <detail property="attr" name="assigned_to_id">
      <old_value>441</old_value>
      <new_value>355</new_value>
    </detail>
  </details>
</journal>
<journal id="639355">
  <user id="529" name="Franck D."/>
  <notes>ce tkt repasse todo pour le run de chgt "sf 4 migration anticipation" statué aujourd'hui avec la team migration sf4.</notes>
  <created_on>2021-06-14T13:19:41Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="639856">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-16T12:07:02Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attachment" name="99023">
      <old_value/>
      <new_value>Capture d’écran 2021-06-16 à 10.45.10.png</new_value>
    </detail>
  </details>
</journal>
<journal id="639857">
  <user id="529" name="Franck D."/>
  <notes>Voilà ci-dessous mon CR de review du changement #66686#note-50 et des décisions/actions consécutives exécutées.

* Identification des éventuel chgt de code spécifiques à ce tkt lors de ce merge :
** la merge request indique ce commit de merge : https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827/diffs?commit_id=53e08b48769f9be1d7c410b439466c97f645e284 ;
** cette vue de commit ne montre pas la séquence de commit de Seb (cf "ses merge request et branche dédiés":https://gitlab.bilendi.net/dev/ddi/-/merge_requests/840) récupérés dans la branche de ce tkt (issue-66686), via ce commit de merge, ni les éventuel chgt spécifiques commités pour résoudre les conflit indiqués en #66686#note-50 (qui ne décrit pas non plus ces éventuels chgt de résolution de conflit...);
** via une contre-vérif "git log -p -cc" de la branche issue-66686, on voit :
*** les commit flaggués "ref #68520" de Seb, 
*** les zones de code, dans les diffs du commit de merge (visibles via l'option -cc), avec de potentielles résolutions de conflit effectuées (car elles ont des diff + et - très contigus de commits des deux branches mergées : exemple : {{collapse()
&lt;pre&gt;

     32 -         "bilendi/back-office-bundle": "^1.11.1", =&gt; issue-66686
     33 +         "bilendi/back-office-bundle": "^1.12.1", =&gt; master
     

&lt;/pre&gt;
}}
*** au final, il n'apparait pas de chgt direct sur les chgt de code fait pour cette évol pour résoudre ces conflit, pour autant de tels chgt des packages "sous-jacent" à l'exécution du code ddi tel que celui de cette évol, nécessite l'exécution des TU de l'app (dont celui de l'évol), pour vérifier la non régression de l'évol, mais aussi d'éventuelles autres parties de code testées;
* Vérification de l'exécution des TU :
** Aucune trace ou argumentation de résultat de test de couverture de ce changement dans #66686#note-50;
** ... vérification du test report du pipeline de merge : &lt;pre&gt;

$ SYMFONY_DEPRECATIONS_HELPER=disabled ./vendor/bin/phpunit
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.
Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!
.IIIIII                                                             7 / 7 (100%)
Time: 00:00.320, Memory: 30.50 MB
OK, but incomplete, skipped, or risky tests!
Tests: 7, Assertions: 3, Incomplete: 6.
&lt;/pre&gt;
** en français après décodage : 7 méthodes de test exécutées, 6 incomplètes (et donc ignorées), 3 assertions (de l'unique méthode de test exécutée donc) ok =&gt; c'est quand même compliqué de valider la non regression qu'avec ça ... après vérif du code de test :
*** c'est bien le test de l'évol qui est exécuté et ok;
*** les 6 autres méthodes de test du "process de déclaration" (script ProcessDeclarationServiceTest.php), ont été marquées comme "incomplètes" dans cette branche issue-66686, et du coup ne sont pas jouées =&gt; ça mérite des explications ça quand même...
*** après discussion (pas très pro active)... et donc surtout des déduction perso en soirée... la raison serait :
*** que pour tester l'évol de ce tkt, on a rajouté dans sa branche issue-66686, un test unitaire =&gt; +1 !
*** mais que comme le framework de test n'était pas déjà configuré pour cette app, il a fallu le faire pour pouvoir rajouter ce test unitaire =&gt; +1 aussi : sauf arbitrage moe/leads de délais/ressources =&gt; il faut créer les composant manquant d'une app quand il y en a le besoin =&gt; et après ça servira pour les autres tkt =&gt; encore +1 !
*** par ailleurs il existe aussi dans ce script de test unitaire du "process de déclaration" : ProcessDeclarationServiceTest.php;
*** et il ne fonctionne pas en l'état car ... il test du code qui n'existe pas (le script ProcessDeclarationService.php) ! =&gt; si ça ça mérite pas aussi des explication...;
*** le seul indice laissé dans le commit de désactivation du script de test ProcessDeclarationServiceTest.php est : 'to fix in #59349' =&gt; vive le jeu de piste !
*** ... et la poursuite de cette "piste" plus tard en soirée est en matinée conclue à :
*** la branche du tkt #59349 ajoute le script ProcessDeclarationService.php, mais n'est à priori à date pas mep vu que ce script n'existe pas dans master à date,
*** et ce message laconique 'to fix in #59349' veut donc dire qu'il faudra ré-activer le script de test ProcessDeclarationServiceTest.php, dans le cadre du tkt #59349, lorsque celui-ci sera à mep (pour autant les deux tkt n'ont pas été liés ni de cmt sur ce poitn dans #59349, donc je me demande comment le dev qui va mep #59349 sera  aware de ça...);
*** mais en fait... après vérif encore plus tard en matinée... ce script ProcessDeclarationService.php ne sera jamais mep car il a été supprimé et donc son script de test ProcessDeclarationServiceTest.php est en fait obsolete !
*** comment j'ai déduis ça :
*** d'après la mr de #59349, la branche issue-59349 contenant le script ProcessDeclarationService.php a été mergée dans une branche "v2" puis supprimée,
*** mais cette branche 'v2' ne contient pas/plus ce script ProcessDeclarationService.php (et a été mergée),
*** et cette contre-vérif dans git (sur master mais aussi testing) : {{collapse()
&lt;pre&gt;
parallels@debian-gnu-linux-10:~/dev/apps/ddi$ git log -p --all --full-history -- "**/ProcessDeclarationService.php"
commit d995942d5e986e558779d8f5846921968b972cde
Merge: 0d73a548 475aed5c
Author: Marc Giraud-Telme &lt;m.giraudtelme@bilendi.com&gt;
Date:   Tue Jun 30 10:24:16 2020 +0200

    Merge branch 'master' into issue-59926

... et après divers commit de merge :

commit d40547d6dbebea180fe6e9c3336cfddaf3f33461
Author: Éric Lernon &lt;e.lernon@bilendi.com&gt;
Date:   Fri Jan 3 18:45:32 2020 +0100

    ref#59349 rewrite the way we check when member earn should move to validated

diff --git a/src/AppBundle/Services/ProcessDeclarationService.php b/src/AppBundle/Services/ProcessDeclarationService.php
deleted file mode 100644
index 71b09c90..00000000
--- a/src/AppBundle/Services/ProcessDeclarationService.php
+++ /dev/null
@@ -1,81 +0,0 @@
-&lt;?php
-
-namespace AppBundle\Services;
-
-use AppBundle\Entity\Company;
-use AppBundle\Entity\Declaration;
-use AppBundle\Entity\DeclarationProduct;
-use AppBundle\Entity\Repository\DeclarationRepository;
-use Bilendi\EarningBundle\EarnManager;
-use Doctrine\ORM\EntityManager;
-use AppBundle\Entity\Repository\CompanyRepository;
-
-class ProcessDeclarationService
-{
-    /**
-     * @var EarnManager
-     */
-    protected $earnManager;
-

...

&lt;/pre&gt;
}}
*** confirme que ce script a été supprimé en janvier 2018, et son script de test n'ayant pas été modifié depuis 2 ans (cf screenshot attaché) =&gt; il est également de fait obsolete;
* Décisions/actions consécutives :
** ProcessDeclarationServiceTest.php a été supprimé dans cette branche;
** la vérif de l'exécution des test unitaires dans le pipeline est ok : {{collapse()
&lt;pre&gt;
$ SYMFONY_DEPRECATIONS_HELPER=disabled ./vendor/bin/phpunit
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.
Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!
.                                                                   1 / 1 (100%)
Time: 00:00.331, Memory: 30.50 MB
OK (1 test, 3 assertions)
&lt;/pre&gt;
}}
** ce test report ne contient plus ces 'incomplete tests' obsoletes.</notes>
  <created_on>2021-06-16T12:07:02Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="639923">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-16T15:14:46Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attachment" name="99036">
      <old_value/>
      <new_value>Capture d’écran 2021-06-16 à 16.30.07.png</new_value>
    </detail>
  </details>
</journal>
<journal id="639924">
  <user id="529" name="Franck D."/>
  <notes>... le merge de MET remonte ce conflit : {{collapse()
&lt;pre&gt;
{
            "name": "phar-io/version",
            "version": "3.1.0",
            "source": {
                "type": "git",
                "url": "https://github.com/phar-io/version.git",
                "reference": "bae7c545bef187884426f042434e561ab1ddb182"
            },
            "dist": {
                "type": "zip",
                "url": "https://api.github.com/repos/phar-io/version/zipball/bae7c545bef187884426f042434e561ab1ddb182",
                "reference": "bae7c545bef187884426f042434e561ab1ddb182",
                "shasum": ""
            },
            "require": {
                "php": "^7.2 || ^8.0"
            },
            "type": "library",
            "autoload": {
                "classmap": [
                    "src/"
                ]
            },
            "notification-url": "https://packagist.org/downloads/",
            "license": [
                "BSD-3-Clause"
            ],
            "authors": [
                {
                    "name": "Arne Blankerts",
                    "email": "arne@blankerts.de",
                    "role": "Developer"
                },
                {
                    "name": "Sebastian Heuer",
                    "email": "sebastian@phpeople.de",
                    "role": "Developer"
                },
                {
                    "name": "Sebastian Bergmann",
                    "email": "sebastian@phpunit.de",
                    "role": "Developer"
                }
            ],
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
            "description": "Library for handling version information and constraints",
            "time": "2021-02-23T14:00:09+00:00"
=======
            "description": "Allows to configure dependency injection using annotations",
            "homepage": "http://jmsyst.com/bundles/JMSDiExtraBundle",
            "keywords": [
                "annotations",
                "dependency injection"
            ],
            "time": "2018-01-12T19:04:30+00:00"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/issue-66686
        },
&lt;/pre&gt;
}}
Il y a forcément un bug quelque part dans la branche issue-66686 car cf :  https://packagist.org/packages/phar-io/version : sa description ne peut pas être : "Allows to configure dependency injection using annotations", ni sa homepage :  "http://jmsyst.com/bundles/JMSDiExtraBundle" =&gt; ça se sont des infos d'un autre package =&gt; donc ce bug intervertissant ces champs entre ces deux packages doit être dans l'un des commmit de l'historique de commit de ce fichier composer.lock;
le screenshot attaché en note #66686#note-53 montre que c'est lors du merge de master (cf no de commit dans le screenshot), probablement lors de la résolution des conflit de merge de #66686#note-50;
du coup y a guère d'autres choix que de revert ce commit de merge et de le refaire, je fais ça dans le cadre de cette review...</notes>
  <created_on>2021-06-16T15:14:46Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640064">
  <user id="529" name="Franck D."/>
  <notes>La résolution du bug de la note précédente est done :
* reset du commit de merge et du commit de suppression du script de test unitaire ProcessDeclarationServiceTest.php décrit dans la note précédente;
** _NB : il faut utiliser l'option -f lors du push de la branche resetée sinon gitlab refuse de la pousser vu qu'elle devient à cause de ces reset, en retard de commit par rapport à sa version dans le repo origin_
* nouveau merge de master avec résolution correcte des conflit du composer.lock, et application d'autres correctif pour les autres regressions induites par ce merge :
** suite au plantage de la résolution de deps par le composer install, suppression de double version dans le composer.lock, de packages 'phar' requis par phpunit =&gt; possiblement du au fait que les deux branches ont commités chacun pour leur propre besoin des version de phpunit différentes =&gt; on a gardé les version les plus récentes de ces pkg et le TU est passé...
** correction d'un passage d'argument dans un cron que phpstan refuse lors du deploy_dev.sh (ça le faisait pas avnt) =&gt; on suppose que ça vient de l'update de version phpstan liée à ce merge =&gt; la solus est de caster l'argument en string;
* cf le commit de ces chgt : https://gitlab.bilendi.net/dev/ddi/-/commit/c9faced6b783c23fc0d99a0c4ea846506438c4eb
* résultat des/du TU ddi sur ces chgt ok : {{collapse()
&lt;pre&gt;
/usr/bin/php /home/parallels/dev/apps/ddi/vendor/phpunit/phpunit/phpunit --configuration /home/parallels/dev/apps/ddi/phpunit.xml.dist --filter Tests\\AppBundle\\Command\\Cron\\ValidatedDeclarationExtractCommandTest --test-suffix ValidatedDeclarationExtractCommandTest.php /home/parallels/dev/apps/ddi/tests/AppBundle/Command/Cron --teamcity
Testing started at 2:22 AM ...
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.

Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!



Time: 00:05.807, Memory: 71.00 MB

OK (1 test, 3 assertions)

Remaining deprecation notices (61)

  9x: Bundle inheritance is deprecated as of 3.4 and will be removed in 4.0.
    6x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    3x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Import\DirectorCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\IntegrityCheckerCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "FOS\JsRoutingBundle\Command\RouterDebugExposedCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "FOS\JsRoutingBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "JMS\TranslationBundle\Command\ResourcesListCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "JMS\TranslationBundle\Command\ExtractTranslationCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Util\DatabaseNameCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Import\RegionalDirectorateDepartmentCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Import\AccountPointsCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\AllMultiProductDeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\ValidEarnMemberReachedTheirQuotasCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\DeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\NewEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\SendEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\DebugCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\WatchCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\SwaggerDumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: getEntityManager is deprecated since Symfony 2.1. Use getManager instead
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Symfony\Bundle\FrameworkBundle\Command\RouterDebugCommand::__construct() expects an instance of "Symfony\Component\Routing\RouterInterface" as first argument since Symfony 3.4. Not passing it is deprecated and will throw a TypeError in 4.0.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  1x: Calling Doctrine\ORM\EntityManager::flush() with any arguments to flush specific entities is deprecated and will not be supported in Doctrine ORM 3.0.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The "Doctrine\Common\Inflector\Inflector::classify" method is deprecated and will be dropped in doctrine/inflector 2.0. Please update to the new Inflector API.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the KERNEL_DIR environment variable or the automatic guessing based on the phpunit.xml / phpunit.xml.dist file location is deprecated since Symfony 3.4. Set the KERNEL_CLASS environment variable to the fully-qualified class name of your Kernel instead. Not setting the KERNEL_CLASS environment variable will throw an exception on 4.0 unless you override the :createKernel() or :getKernelClass() method.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Autowiring services based on the types they implement is deprecated since Symfony 3.3 and won't be supported in version 4.0. Try changing the type-hint for argument "$earnManager" of method "Tests\DataFixtures\ORM\LoadEarnData::__construct()" to "Bilendi\EarningBundle\EarnManagerInterface" instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_BaseNodeVisitor" class is deprecated since Twig version 2.7, use "Twig\NodeVisitor\AbstractNodeVisitor" instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_RuntimeLoaderInterface" class is deprecated since Twig version 2.7, use "Twig\RuntimeLoader\RuntimeLoaderInterface" instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The Symfony\Component\ClassLoader\ClassLoader class is deprecated since Symfony 3.3 and will be removed in 4.0. Use Composer instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "form_login" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "guard" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The "app.file.export.ftp" service is private, getting it from the container is deprecated since Symfony 3.2 and will fail in 4.0. You should either make the service public, or stop using the container directly and use dependency injection instead.
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

Process finished with exit code 1

&lt;/pre&gt;
}}
** _les deprecated sf4 seront traitées dans le cadre de la migration sf4_

la met de ce chgt est à venir...</notes>
  <created_on>2021-06-17T10:21:12Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640072">
  <user id="529" name="Franck D."/>
  <notes>MET DONE NOW (content : needed changes to be compliant with the future symfony 4 migration)</notes>
  <created_on>2021-06-17T10:31:21Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>2</old_value>
      <new_value>8</new_value>
    </detail>
    <detail property="attr" name="assigned_to_id">
      <old_value>355</old_value>
      <new_value>441</new_value>
    </detail>
  </details>
</journal>
<journal id="640075">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-17T10:49:54Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocked">
      <old_value/>
      <new_value>68520</new_value>
    </detail>
  </details>
</journal>
<journal id="640076">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-17T10:55:21Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attachment" name="99045">
      <old_value/>
      <new_value>Capture d’écran 2021-06-16 à 16.30.07.png</new_value>
    </detail>
    <detail property="attr" name="assigned_to_id">
      <old_value>441</old_value>
      <new_value>355</new_value>
    </detail>
  </details>
</journal>
<journal id="640078">
  <user id="529" name="Franck D."/>
  <notes>forget the previous note with a black screenshot =&gt; redmine bug.

After planning meeting, this tkt is set as blocked by the ddi sf4 migration tkt as it has been stated during this meeting that ddi requested delay for testing this tkt is up to august, whereas the expected sf4 migration delay is july, so if those delay are respected, then code of this tkt will have to be migrated to sf 4 before being pushed in production.
If ever the expected delays above wouldn't be respected then, one may remove this blocking link between both tickets, depending on the up to date (forecasted) delays.
Note : this is a "PROD" blocking, as this tkt is pushed in testing (still in symfony 3), for ddi test from now to august.
Once validated by ddi, this tkt can be safely tested for non technical regressions after its migration to sf 4 and mep.</notes>
  <created_on>2021-06-17T11:02:20Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="640341">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:34:03Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="relates">
      <old_value>67188</old_value>
      <new_value/>
    </detail>
  </details>
</journal>
<journal id="640343">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:34:13Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocks">
      <old_value/>
      <new_value>67188</new_value>
    </detail>
  </details>
</journal>
<journal id="640360">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T16:43:23Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>lire : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
    <detail property="attr" name="description">
      <old_value>[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement

{{collapse()

https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640361">
  <user id="529" name="Franck D."/>
  <notes>Déscription dans la procédure de déploiement des spécificité de gestion de la branche du tkt #67188 : dev/test/commit/push/review/met.
Ajout de notif aux dev/leads des ces spécificités.</notes>
  <created_on>2021-06-18T16:43:23Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640362">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T16:44:51Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement

{{collapse()

https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

}}</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement



Lire : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
  </details>
</journal>
<journal id="640363">
  <user id="529" name="Franck D."/>
  <notes>correction mineure</notes>
  <created_on>2021-06-18T16:44:51Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640365">
  <user id="529" name="Franck D."/>
  <notes>nouvelle met (purement de réorg de gestion de branche/code avec #67188) faite aujourd'hui : cf https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</notes>
  <created_on>2021-06-18T16:57:20Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640370">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:09:37Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>lire : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640372">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:10:19Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640378">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:12:26Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON :
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640379">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:12:52Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON :
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON :
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETES :
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834
Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640599">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T16:19:56Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocks">
      <old_value/>
      <new_value>65191</new_value>
    </detail>
  </details>
</journal></issue_66686>
<issue_66685>
<issue_url>https://redmine.bilendi.com/issues/66685</issue_url>
<journal id="640339">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:31:01Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*
2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value/>
      <new_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
  </details>
</journal>
<journal id="640340">
  <user id="529" name="Franck D."/>
  <notes>ajout branche ds les tech infos et lien vers le procédure deploiement décrivant les action de deploy spécifiques pour les sous tkt de ce tkt</notes>
  <created_on>2021-06-18T15:31:01Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640359">
  <user id="529" name="Franck D."/>
  <notes>Déscription dans la procédure de déploiement des spécificité de gestion de la branche du tkt #67188 : dev/test/commit/push/review/met.
Ajout de notif aux dev/leads des ces spécificités.</notes>
  <created_on>2021-06-18T16:39:57Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire  en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._

}}</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</old_value>
      <new_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
deploy spécifique :
 voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
  </details>
</journal>
<journal id="640367">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:07:28Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire  en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._

}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
deploy spécifique :
 voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</old_value>
      <new_value>voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640368">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:08:15Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640369">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:08:36Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640371">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:10:01Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640381">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:13:47Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640389">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T06:36:10Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640390">
  <user id="529" name="Franck D."/>
  <notes>recopie de la proc de deploy après mauvaise manip redmine l'ayant supprimée...</notes>
  <created_on>2021-06-21T06:36:10Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640391">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T06:44:15Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne pas dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que ces TU des deux branches intégrées ainsi passent, vu que le code de l'une dépend de l'autre;
* la mep de issue-67188 suit le même principe que sa met.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640392">
  <user id="529" name="Franck D."/>
  <notes>quelques correc et ajout de précision dans le procédure de deploy.</notes>
  <created_on>2021-06-21T06:44:15Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640393">
  <user id="529" name="Franck D."/>
  <notes>NB : la valeur du champ estimation ne prend pas en compte les évol successives demandées par le client après sa demande initiale.</notes>
  <created_on>2021-06-21T06:46:57Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640603">
  <user id="529" name="Franck D."/>
  <notes>Ajout de la nouvelle branche issue-65191_v2 dans la section "procedure de déploiement" car elle suit le même spécificités de gestion que issue-67188.</notes>
  <created_on>2021-06-21T16:38:03Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne pas dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que ces TU des deux branches intégrées ainsi passent, vu que le code de l'une dépend de l'autre;
* la mep de issue-67188 suit le même principe que sa met.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640644">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-22T07:49:06Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard, mais doit être systématiquement mergée dans issue-66685, et metée ou mepée via la met/mep de issue-66685, afin de gérer les résolution de conflit potentiel avec les deux autres branches issue-67188 et issue-65191 :
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640645">
  <user id="529" name="Franck D."/>
  <notes>petite correction de la procédure de deploy concernant la gestion de la branche de #66686.</notes>
  <created_on>2021-06-22T07:49:06Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640660">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-22T09:26:21Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard, mais doit être systématiquement mergée dans issue-66685, et metée ou mepée via la met/mep de issue-66685, afin de gérer les résolution de conflit potentiel avec les deux autres branches issue-67188 et issue-65191 :
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard, mais doit être systématiquement mergée dans issue-66685, et metée ou mepée via la met/mep de issue-66685, afin de gérer les résolution de conflit potentiel avec les deux autres branches issue-67188 et issue-65191 :
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686;
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640661">
  <user id="529" name="Franck D."/>
  <notes>petite correction de la section procédure de déploiement après re-vérif des merge request des trois sous tkt...</notes>
  <created_on>2021-06-22T09:26:21Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640670">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-22T09:44:59Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocks">
      <old_value/>
      <new_value>68520</new_value>
    </detail>
  </details>
</journal></issue_66685>
<issue_66617>
<issue_url>https://redmine.bilendi.com/issues/66617</issue_url>
</issue_66617>
<issue_66532>
<issue_url>https://redmine.bilendi.com/issues/66532</issue_url>
</issue_66532>
<issue_66528>
<issue_url>https://redmine.bilendi.com/issues/66528</issue_url>
</issue_66528>
<issue_66517>
<issue_url>https://redmine.bilendi.com/issues/66517</issue_url>
</issue_66517>
<issue_66486>
<issue_url>https://redmine.bilendi.com/issues/66486</issue_url>
</issue_66486>
<issue_66452>
<issue_url>https://redmine.bilendi.com/issues/66452</issue_url>
</issue_66452>
<issue_66380>
<issue_url>https://redmine.bilendi.com/issues/66380</issue_url>
</issue_66380>
<issue_66326>
<issue_url>https://redmine.bilendi.com/issues/66326</issue_url>
</issue_66326>
<issue_66317>
<issue_url>https://redmine.bilendi.com/issues/66317</issue_url>
</issue_66317>
<issue_66316>
<issue_url>https://redmine.bilendi.com/issues/66316</issue_url>
</issue_66316>
<issue_66315>
<issue_url>https://redmine.bilendi.com/issues/66315</issue_url>
</issue_66315>
<issue_66314>
<issue_url>https://redmine.bilendi.com/issues/66314</issue_url>
</issue_66314>
<issue_66312>
<issue_url>https://redmine.bilendi.com/issues/66312</issue_url>
</issue_66312>
<issue_66308>
<issue_url>https://redmine.bilendi.com/issues/66308</issue_url>
</issue_66308>
<issue_66306>
<issue_url>https://redmine.bilendi.com/issues/66306</issue_url>
</issue_66306>
<issue_66303>
<issue_url>https://redmine.bilendi.com/issues/66303</issue_url>
</issue_66303>
<issue_66294>
<issue_url>https://redmine.bilendi.com/issues/66294</issue_url>
</issue_66294>
<issue_66104>
<issue_url>https://redmine.bilendi.com/issues/66104</issue_url>
</issue_66104>
<issue_66083>
<issue_url>https://redmine.bilendi.com/issues/66083</issue_url>
</issue_66083>
<issue_65945>
<issue_url>https://redmine.bilendi.com/issues/65945</issue_url>
</issue_65945>
<issue_65841>
<issue_url>https://redmine.bilendi.com/issues/65841</issue_url>
</issue_65841>
<issue_65830>
<issue_url>https://redmine.bilendi.com/issues/65830</issue_url>
</issue_65830>
<issue_65622>
<issue_url>https://redmine.bilendi.com/issues/65622</issue_url>
</issue_65622>
<issue_65609>
<issue_url>https://redmine.bilendi.com/issues/65609</issue_url>
</issue_65609>
<issue_65276>
<issue_url>https://redmine.bilendi.com/issues/65276</issue_url>
<journal id="640408">
  <user id="529" name="Franck D."/>
  <notes>sum-up of our last friday's talk with Robin :
* first topic discussed : reborn of solution process to solve the "signature key" issue (draft):
** mains steps (their order and completness is not validated yet):
*** reset the existing key in Deutche Bank platform, generate and re-send the INI Letter with the new key, and wait for its activation notification from Deutche Bank;
*** configure the usb key on Exabank side with Adrien (Exalog) and Robin (live call), from the Exabank doc describing it : download and install Sconnect plugin (from swift) in Robin's browser, configure the key in Exabank BO etc... =&gt; Adrien as agreed (a long time ago now) to assist us in this task...;
* second topic : evolution random thoughts to manage frauders :
** tools that could assist in identifying fauders : maybe some kind of "knowledge base" of known useful check on member datas (on their email ...), maybe correlation reports on datas between ccc, database datas, xml transfer files ...;
** possibility of browsing the xml transfer files (integrated with the database), in a dedicated way : filtering on idMembre, name, email, amount ...;
** tools to cancel credits transfer requests identified as the ones of a frauder :
** once a credit transfer has been identified as doubtful from the previous frauders identification phase, then clic on the credit to flag it as "to cancel";
** provide a view of the credits flagged as "to cancel";
** clic on a "validate" button as a final validation of the credits "to cancel" =&gt; the "to cancel" credits are removed from the xml file and the file is resent to Exabank, the credits are flagged as canceled in db, the credits amounts are re-added to the members site accounts (not bank accounts), sothat these accounts are balanced with the credit cancellations (even if these accounts are "frauders accounts" and so blacklisted);
** once this "transfer credit check" step is completed, the user can go in Exabank and trigger the sending of the file;
** Additional features would help identify and solve potential differences when their are technical issues with the automated credit file transfer, leading in manual actions to solve/work around the issue and send the file : "check the diff of number of credits between the xml files and the database" and/or "check the diff of total amount between the xml file and the database", and/or check this amount diff "by credit".</notes>
  <created_on>2021-06-21T07:35:07Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640750">
  <user id="529" name="Franck D."/>
  <notes>ok, so after checking the history, one as to catch-up the process from the step 7 in note #65276#note-33;
I copy the remaining effective steps below (with the owners of each step) :
# Reiner, Franck : reset the Exabanque signing and sending certificates configuration;
# Robin, Pablo(Exalog), Franck : configure Robin's computer's browser with this usb key;
# Reiner, Franck, Robin : resend to Deutsche Bank the corresponding "INI letter" with the new keys values (by fax to +49 3411202727 and to Martin);
# Robin : wait (a few days) the notification from Deutsche Bank, of the official activation of the User ID : AD151999 (sending) and AD151807 (signing) and notify Franck of it;
# Robin, Adrien(Exalog), Franck, Reiner :redo the "send file" test;</notes>
  <created_on>2021-06-22T13:13:13Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="641090">
  <user id="529" name="Franck D."/>
  <notes>Breakdown and update of #65276#note-45 issue fix global process :

h3. People

* Robin : Bilendi / Meinungplatz business team;
* Reiner (backup Sacha) : Deutche Bank IT support;
* Pablo (backup Adrien) : Exalog/Exabanque IT support;
* Franck : Bilendi IT support;

h3. Concrete process

# -Reiner, Franck : reset the Exabanque signing and sending certificates configuration;-
** Status : Deutche Bank support confirmed that the key values have been reseted and that the new key values can be initialized first, and the corresponding INI letter sent next;
# Robin, Pablo, Franck : configure Robin's computer's browser with this usb key;
## [WIP]Robin, Franck : recall the file sending scenario and get from Robin the target computers OS and browsers of the authorized persons that will execute this scenario (these persons should own a 3SKey signing usb key);
*** Status : request channed to Robin;
## Robin, Pablo, Franck : with the answer of previous task : execute the procedure provided by Pablo in the attached screenshot "Capture d’écran 2021-06-23 à 14.13.53.png" for Robin authorized person;
# Reiner, Franck, Robin : resend to Deutsche Bank the corresponding "INI letter" with the new keys values (by fax to +49 3411202727 and to Martin);
## Reiner, Franck :  before resending the "INI letter" to Deutsche Bank, check first with Reiner that the calls of the "appel ebics INI" and "ebics HIA", in the step 5 of the previous task, have effectively updated the Deutsche Bank User ID AD151999 (sending) and AD151807 (signing), with the new keys;
## Reiner, Franck, Robin : if previous check is KO then investigate the issue, if it's OK then Franck makes sure Robin has access to the "INI Letter" and Robin sends these "INI Letter" (only authorized persons send such a letter), by fax to +49 3411202727 and to Martin (or like Robin did it last time);
# Robin : wait (a few days) the notification from Deutsche Bank, of the official activation of the User ID : AD151999 (sending) and AD151807 (signing) and notify Franck of it;
# Robin, Pablo, Franck, Reiner :redo the "send file" test;
** Status : TODO Franck : make a concrete breakdown of this issue fix validation test scenario execution, when the previous tasks are completed.
# When the previous step is ok, redo the all the previous steps for all others authorized persons (except the ones not mandatory for this person).</notes>
  <created_on>2021-06-23T14:07:33Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attachment" name="99144">
      <old_value/>
      <new_value>Capture d’écran 2021-06-23 à 14.13.53.png</new_value>
    </detail>
  </details>
</journal></issue_65276>
<issue_65275>
<issue_url>https://redmine.bilendi.com/issues/65275</issue_url>
</issue_65275>
<issue_65191>
<issue_url>https://redmine.bilendi.com/issues/65191</issue_url>
<journal id="639358">
  <user id="529" name="Franck D."/>
  <notes>ce tkt repasse todo pour le run de chgt "sf 4 migration anticipation" statué aujourd'hui avec la team migration sf4.</notes>
  <created_on>2021-06-14T13:21:24Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>20</old_value>
      <new_value>2</new_value>
    </detail>
  </details>
</journal>
<journal id="640161">
  <user id="529" name="Franck D."/>
  <notes>je vois pas de merge de master pour cette branche là, hors c'est ce qui a été convenu dans le meeting sf4.</notes>
  <created_on>2021-06-17T14:41:58Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>20</old_value>
      <new_value>2</new_value>
    </detail>
  </details>
</journal>
<journal id="640593">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T16:14:55Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>Afin de synchroniser automatiquement le fichier des commandes Master avec SAP chez le client il faudrait évaluer la charge de travail pour créer un fichier additionnel aavec le dessin d'enregistrement suivant.

Dépôt sur le FTP
Fréquence : Non déterminé (Quotidien ou bi-quotidien)
Format : CSV

Spec du client en document joint.


|_.N°	|_.Champs SPELOG	|_.Champs BO	|_.Données	|_.Remarques	|
|1	|CDECLIREF	|4	|Numéro de commande	|N° de commande dans BILENDI	|
|2	|CDLDATCLI	|12	|Date d'échange	|	|
|3	|CLICODCDE	|1	|N° vip	|N° du compte client VIP	|
|4	|ETSNUMCDE	|	|DDTH_fre-FR	|Constante (marque De Dietrich)	|
|5	|CDETYP	|	|ZVP / ZVF	"|Règle à définir pour le type de commande
Commande point = ZVP
Commande facturée : ZVF"	|
|6	|PROREF	|6	|Rèf.	|Reference de l’article	|
|7	|CDLCUMQTE	|13	|Qté	|	|
|8	|CDLPXVNET	|	|	|	|
|9	|COMMENTAIRE	|	|	|Si existe possible	|
|10	|CLIENTADR1	|3	|Nom société	|	|
|11	|CLIENTADR2	|9	|Adresse de livraison	|Découpage : n° rue	|
|12	|CLIENTADR3	|10	|Numéro de telephone	|	|
|13	|CLIENTADR4	|11	|Numéro de telephone mobile	|	|
|14	|CLIENTCP	|9	|Adresse de livraison	|Découpage : Code Postal	|
|15	|CLIENTVILLE	|9	|Adresse de livraison	|Découpage :Ville	|
|16	|CLIENTEMAIL	|2	|Email	|	|
|17	|CLIENTPAYS	|9	|Adresse de livraison	|Pays : FR	|
|18	|CODEGIA	|	|N/A	|	|
|19	|TYPEXPE	|	|N/A	|	|
|20	|DOSSIERRETOUR	|	|N/A	|	|
|21	|SYMPTOME	|	|N/A	|	|
|22	|NOSERIE	|	|N/A	|	|
|23	|DATEMES	|	|N/A	|	|
|24	|CODEPROD	|	|N/A	|	|
|25	|OBSERVATION	|	|N/A	|	|
|26	|CLIENTOWNREF	|	|N/A	|	|</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

Afin de synchroniser automatiquement le fichier des commandes Master avec SAP chez le client il faudrait évaluer la charge de travail pour créer un fichier additionnel aavec le dessin d'enregistrement suivant.

Dépôt sur le FTP
Fréquence : Non déterminé (Quotidien ou bi-quotidien)
Format : CSV

Spec du client en document joint.


|_.N°	|_.Champs SPELOG	|_.Champs BO	|_.Données	|_.Remarques	|
|1	|CDECLIREF	|4	|Numéro de commande	|N° de commande dans BILENDI	|
|2	|CDLDATCLI	|12	|Date d'échange	|	|
|3	|CLICODCDE	|1	|N° vip	|N° du compte client VIP	|
|4	|ETSNUMCDE	|	|DDTH_fre-FR	|Constante (marque De Dietrich)	|
|5	|CDETYP	|	|ZVP / ZVF	"|Règle à définir pour le type de commande
Commande point = ZVP
Commande facturée : ZVF"	|
|6	|PROREF	|6	|Rèf.	|Reference de l’article	|
|7	|CDLCUMQTE	|13	|Qté	|	|
|8	|CDLPXVNET	|	|	|	|
|9	|COMMENTAIRE	|	|	|Si existe possible	|
|10	|CLIENTADR1	|3	|Nom société	|	|
|11	|CLIENTADR2	|9	|Adresse de livraison	|Découpage : n° rue	|
|12	|CLIENTADR3	|10	|Numéro de telephone	|	|
|13	|CLIENTADR4	|11	|Numéro de telephone mobile	|	|
|14	|CLIENTCP	|9	|Adresse de livraison	|Découpage : Code Postal	|
|15	|CLIENTVILLE	|9	|Adresse de livraison	|Découpage :Ville	|
|16	|CLIENTEMAIL	|2	|Email	|	|
|17	|CLIENTPAYS	|9	|Adresse de livraison	|Pays : FR	|
|18	|CODEGIA	|	|N/A	|	|
|19	|TYPEXPE	|	|N/A	|	|
|20	|DOSSIERRETOUR	|	|N/A	|	|
|21	|SYMPTOME	|	|N/A	|	|
|22	|NOSERIE	|	|N/A	|	|
|23	|DATEMES	|	|N/A	|	|
|24	|CODEPROD	|	|N/A	|	|
|25	|OBSERVATION	|	|N/A	|	|
|26	|CLIENTOWNREF	|	|N/A	|	|

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement


Lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/merge_requests/830
php bin/console app:cron:export-orders (a brancher quotidiennement)</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
 https://gitlab.bilendi.net/dev/ddi/-/merge_requests/845

CRON :
php bin/console app:cron:export-orders (a brancher quotidiennement)

OBSOLETE :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/830</new_value>
    </detail>
  </details>
</journal>
<journal id="640594">
  <user id="529" name="Franck D."/>
  <notes>Re-structured branches to get only the code specific to this tkt in the branch of this tkt ans its merge request and referenced the section telling the workflow specifities of these new branch and merge request.</notes>
  <created_on>2021-06-21T16:14:55Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640600">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T16:19:56Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocked">
      <old_value/>
      <new_value>66686</new_value>
    </detail>
  </details>
</journal>
<journal id="640656">
  <user id="529" name="Franck D."/>
  <notes>MET DONE NOW : content : sf4 changes to enable sf4 migration wip (in tkt #68520), and prepare future sf4 migration of the code of this export.</notes>
  <created_on>2021-06-22T08:58:25Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>2</old_value>
      <new_value>8</new_value>
    </detail>
    <detail property="attr" name="assigned_to_id">
      <old_value>355</old_value>
      <new_value>441</new_value>
    </detail>
  </details>
</journal></issue_65191>
<issue_65015>
<issue_url>https://redmine.bilendi.com/issues/65015</issue_url>
</issue_65015>
<issue_64929>
<issue_url>https://redmine.bilendi.com/issues/64929</issue_url>
</issue_64929>
<issue_64927>
<issue_url>https://redmine.bilendi.com/issues/64927</issue_url>
</issue_64927>
<issue_64854>
<issue_url>https://redmine.bilendi.com/issues/64854</issue_url>
</issue_64854>
<issue_64773>
<issue_url>https://redmine.bilendi.com/issues/64773</issue_url>
</issue_64773>
<issue_64720>
<issue_url>https://redmine.bilendi.com/issues/64720</issue_url>
</issue_64720>
<issue_64717>
<issue_url>https://redmine.bilendi.com/issues/64717</issue_url>
</issue_64717>
<issue_64653>
<issue_url>https://redmine.bilendi.com/issues/64653</issue_url>
</issue_64653>
<issue_64634>
<issue_url>https://redmine.bilendi.com/issues/64634</issue_url>
</issue_64634>
<issue_64633>
<issue_url>https://redmine.bilendi.com/issues/64633</issue_url>
</issue_64633>
<issue_64632>
<issue_url>https://redmine.bilendi.com/issues/64632</issue_url>
</issue_64632>
<issue_64630>
<issue_url>https://redmine.bilendi.com/issues/64630</issue_url>
</issue_64630>
<issue_64628>
<issue_url>https://redmine.bilendi.com/issues/64628</issue_url>
</issue_64628>
<issue_64587>
<issue_url>https://redmine.bilendi.com/issues/64587</issue_url>
</issue_64587>
<issue_64506>
<issue_url>https://redmine.bilendi.com/issues/64506</issue_url>
</issue_64506>
<issue_64477>
<issue_url>https://redmine.bilendi.com/issues/64477</issue_url>
</issue_64477>
<issue_64388>
<issue_url>https://redmine.bilendi.com/issues/64388</issue_url>
</issue_64388>
<issue_64372>
<issue_url>https://redmine.bilendi.com/issues/64372</issue_url>
</issue_64372>
<issue_64309>
<issue_url>https://redmine.bilendi.com/issues/64309</issue_url>
</issue_64309>
<issue_64304>
<issue_url>https://redmine.bilendi.com/issues/64304</issue_url>
</issue_64304>
<issue_64302>
<issue_url>https://redmine.bilendi.com/issues/64302</issue_url>
</issue_64302>
<issue_64287>
<issue_url>https://redmine.bilendi.com/issues/64287</issue_url>
</issue_64287>
<issue_64286>
<issue_url>https://redmine.bilendi.com/issues/64286</issue_url>
</issue_64286>
<issue_64273>
<issue_url>https://redmine.bilendi.com/issues/64273</issue_url>
</issue_64273>
<issue_64262>
<issue_url>https://redmine.bilendi.com/issues/64262</issue_url>
</issue_64262>
<issue_64216>
<issue_url>https://redmine.bilendi.com/issues/64216</issue_url>
</issue_64216>
<issue_64128>
<issue_url>https://redmine.bilendi.com/issues/64128</issue_url>
</issue_64128>
<issue_64127>
<issue_url>https://redmine.bilendi.com/issues/64127</issue_url>
</issue_64127>
<issue_63977>
<issue_url>https://redmine.bilendi.com/issues/63977</issue_url>
</issue_63977>
<issue_63976>
<issue_url>https://redmine.bilendi.com/issues/63976</issue_url>
</issue_63976>
<issue_63975>
<issue_url>https://redmine.bilendi.com/issues/63975</issue_url>
</issue_63975>
<issue_63974>
<issue_url>https://redmine.bilendi.com/issues/63974</issue_url>
</issue_63974>
<issue_63847>
<issue_url>https://redmine.bilendi.com/issues/63847</issue_url>
</issue_63847>
<issue_63782>
<issue_url>https://redmine.bilendi.com/issues/63782</issue_url>
<journal id="641117">
  <user id="529" name="Franck D."/>
  <notes>Voilà le mail que j'ai convenu avec Serge Adam (au tel ce matin), d'envoyer à son support pour corriger ce bug suite à une nouvelle occurence de celui-ci lors de leur rejet du fichier de prlvt du 19/06 : {{collapse()
&lt;pre&gt;
Bonjour,
 
mon Numéro d'abonné ftp-bank : H00030K

lors de deux dernières erreur d'envoi en banque que nous avons eu à traiter j'ai remarqué que le fichier d'erreur produit (ceux que votre script créé dans le repertoire "error"), ne contient plus l'extension .err :

voilà ci-dessous un listing des fichier d'erreur que l'un de nos script recupère de ce repertoire "error".
il est convenu de longue date que ces fichier soient suffixés avec l'extension .err de sorte qu'ils aient le même nom que le fichier de log de l'erreur que votre script produit également à l'extension près (.xml dans le cas du fichier de log).
ainsi une tâche cron chez nous récupère les couples de fichier (error/xxx.err , log/xxx.log) et envoi une alerte que le support chez nous peut traiter.

j'avais déjà alerté par tel Serge il y a 9 mois dans le cas du fichier d'erreur UGCFR-2020-09-03-2020-09-10.2.xml.20200903023859.maximiles_20200903_121109
qui m'avait dit que ce serait corrigé mais suite à la nouvelle alerte de ce week-end  (fichier UGCFR-2021-06-19-2021-06-28.1.xml.20210619005522.maximiles_20210619_211937),je vois que ce n'est tjs pas corrigé.merci de gérer rapidement cette regression
Franck DelahayeDev leadBilendi technology

f.delahaye@job-1i:~$ ls -ltr /home/shared/ftp-bank/production/storage/errors/error/
total 298568
-rw-rw-r-- 1 ftp-bank www-data 31948800 Feb 27  2013 UGCFR-2013-03-05.txt.20130227013609.maximiles_20130227_113319.tosend
-rw-rw-r-- 1 ftp-bank www-data 32504303 Nov 22  2013 2013-11-20-debit-orders-FR.2.xml.maximiles_20131122_084950
-rw-rw-r-- 1 ftp-bank www-data 74098327 Nov 22  2013 2013-11-20-debit-orders-FR.xml.maximiles_20131122_084955
-rw-rw-r-- 1 ftp-bank www-data    58522 Jul 11  2016 UGCFR-2016-07-10-2016-07-19.1.xml.20160710010418.maximiles_20160711_091029
-rw-r--r-- 1 ftp-bank www-data 36987220 Sep  4  2020 UGCFR-2020-09-03-2020-09-10.3.xml.20200903023859.maximiles_20200903_121108
-rw-r--r-- 1 ftp-bank www-data 37033970 Sep  4  2020 UGCFR-2020-09-03-2020-09-10.2.xml.20200903023859.maximiles_20200903_121109
-rw-r--r-- 1 ftp-bank www-data 18244128 Sep  4  2020 UGCFR-2020-09-03-2020-09-10.5.xml.20200903023859.maximiles_20200903_121106
-rw-r--r-- 1 ftp-bank www-data 36977171 Sep  4  2020 UGCFR-2020-09-03-2020-09-10.4.xml.20200903023859.maximiles_20200903_121106
-rw-r--r-- 1 ftp-bank www-data 37056091 Sep  4  2020 UGCFR-2020-09-03-2020-09-10.1.xml.20200903023859.maximiles_20200903_121107
-rw-r--r-- 1 ftp-bank www-data     2969 May 10 14:01 UGCFR-2021-05-08-2021-05-18.1.xml.20210508005900.maximiles_20210508_083736.err
-rw-r--r-- 1 ftp-bank www-data     2234 May 17 11:01 UGCFR-2021-05-12-2021-05-20.1.xml.20210512010901.maximiles_20210512_083745.err
-rw-r--r-- 1 ftp-bank www-data     9852 May 17 11:01 UGCFR-2021-05-13-2021-05-21.1.xml.20210513005856.maximiles_20210513_083746.err
-rw-r--r-- 1 ftp-bank www-data    27628 May 17 11:01 UGCFR-2021-05-15-2021-05-25.1.xml.20210515005836.maximiles_20210515_083742.err
-rw-r--r-- 1 ftp-bank www-data    15486 May 17 11:01 UGCFR-2021-05-17-2021-05-25.1.xml.20210517005843.maximiles_20210517_083744.err
-rw-r--r-- 1 ftp-bank www-data   233320 Jun 21 12:01 UGCFR-2021-06-19-2021-06-28.1.xml.20210619005522.maximiles_20210619_211937
-rw-r--r-- 1 ftp-bank www-data    15640 Jun 22 12:01 UGCFR-2021-05-17-2021-05-25.1.xml.20210622105600.maximiles_20210622_113748.err
-rw-r--r-- 1 ftp-bank www-data     9937 Jun 22 12:01 UGCFR-2021-05-13-2021-05-21.1.xml.20210622105600.maximiles_20210622_113751.err
-rw-r--r-- 1 ftp-bank www-data    27905 Jun 22 12:01 UGCFR-2021-05-15-2021-05-25.1.xml.20210622105600.maximiles_20210622_113818.err
-rw-r--r-- 1 ftp-bank www-data     2987 Jun 22 12:01 UGCFR-2021-05-08-2021-05-18.1.xml.20210622105600.maximiles_20210622_113825.err
-rw-r--r-- 1 ftp-bank www-data   428047 Jun 22 12:01 UGCFR-2021-05-20-2021-05-28.1.xml.20210622105600.maximiles_20210622_113828.err
-rw-r--r-- 1 ftp-bank www-data     2244 Jun 22 12:01 UGCFR-2021-05-12-2021-05-20.1.xml.202
&lt;/pre&gt;
}}</notes>
  <created_on>2021-06-23T14:54:52Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="641238">
  <user id="529" name="Franck D."/>
  <notes>... ils ont ouvert un tkt pour ça  : {{collapse()
&lt;pre&gt;
BANKX-MC Re: les fichier d'erreur produit par votre script d'envoi en banque ne contiennent pplus l'extension .err
External
Inbox

Assistance
Wed, 23 Jun, 17:26 (18 hours ago)
to me, Assistance

   
Translate message
Turn off for: French
Bonjour,

Nous ouvrons un ticket auprès de notre service d'exploitation et revenons vers vous.

Cordialement,

Mihai CHITIC
&lt;/pre&gt;
}}</notes>
  <created_on>2021-06-24T09:38:34Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal></issue_63782>
<issue_63320>
<issue_url>https://redmine.bilendi.com/issues/63320</issue_url>
</issue_63320>
<issue_63251>
<issue_url>https://redmine.bilendi.com/issues/63251</issue_url>
</issue_63251>
<issue_63190>
<issue_url>https://redmine.bilendi.com/issues/63190</issue_url>
</issue_63190>
<issue_63180>
<issue_url>https://redmine.bilendi.com/issues/63180</issue_url>
</issue_63180>
<issue_62912>
<issue_url>https://redmine.bilendi.com/issues/62912</issue_url>
</issue_62912>
<issue_62910>
<issue_url>https://redmine.bilendi.com/issues/62910</issue_url>
</issue_62910>
<issue_62776>
<issue_url>https://redmine.bilendi.com/issues/62776</issue_url>
</issue_62776>
<issue_62773>
<issue_url>https://redmine.bilendi.com/issues/62773</issue_url>
</issue_62773>
<issue_62772>
<issue_url>https://redmine.bilendi.com/issues/62772</issue_url>
</issue_62772>
<issue_62704>
<issue_url>https://redmine.bilendi.com/issues/62704</issue_url>
</issue_62704>
<issue_62531>
<issue_url>https://redmine.bilendi.com/issues/62531</issue_url>
</issue_62531>
<issue_62321>
<issue_url>https://redmine.bilendi.com/issues/62321</issue_url>
</issue_62321>
<issue_62303>
<issue_url>https://redmine.bilendi.com/issues/62303</issue_url>
</issue_62303>
<issue_62279>
<issue_url>https://redmine.bilendi.com/issues/62279</issue_url>
</issue_62279>
<issue_62274>
<issue_url>https://redmine.bilendi.com/issues/62274</issue_url>
</issue_62274>
<issue_62241>
<issue_url>https://redmine.bilendi.com/issues/62241</issue_url>
</issue_62241>
<issue_62209>
<issue_url>https://redmine.bilendi.com/issues/62209</issue_url>
</issue_62209>
<issue_61847>
<issue_url>https://redmine.bilendi.com/issues/61847</issue_url>
</issue_61847>
<issue_61818>
<issue_url>https://redmine.bilendi.com/issues/61818</issue_url>
</issue_61818>
<issue_61746>
<issue_url>https://redmine.bilendi.com/issues/61746</issue_url>
</issue_61746>
<issue_61743>
<issue_url>https://redmine.bilendi.com/issues/61743</issue_url>
</issue_61743>
<issue_61740>
<issue_url>https://redmine.bilendi.com/issues/61740</issue_url>
</issue_61740>
<issue_61487>
<issue_url>https://redmine.bilendi.com/issues/61487</issue_url>
</issue_61487>
<issue_61451>
<issue_url>https://redmine.bilendi.com/issues/61451</issue_url>
</issue_61451>
<issue_60366>
<issue_url>https://redmine.bilendi.com/issues/60366</issue_url>
</issue_60366>
<issue_59787>
<issue_url>https://redmine.bilendi.com/issues/59787</issue_url>
<journal id="640932">
  <user id="529" name="Franck D."/>
  <notes>3min15s d'indispo cette nuit sur mxm : première trace : {{collapse()
&lt;pre&gt;
[2021-06-23 00:12:50] request.CRITICAL: Uncaught PHP Exception Doctrine\DBAL\Exception\ConnectionException: "An exception occurred in driver: SQLSTATE[08006] [7] timeout expired" at
&lt;/pre&gt;
}}</notes>
  <created_on>2021-06-23T06:07:21Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal></issue_59787>
<issue_59744>
<issue_url>https://redmine.bilendi.com/issues/59744</issue_url>
</issue_59744>
<issue_59518>
<issue_url>https://redmine.bilendi.com/issues/59518</issue_url>
</issue_59518>
<issue_58945>
<issue_url>https://redmine.bilendi.com/issues/58945</issue_url>
</issue_58945>
<issue_57902>
<issue_url>https://redmine.bilendi.com/issues/57902</issue_url>
</issue_57902>
<issue_57339>
<issue_url>https://redmine.bilendi.com/issues/57339</issue_url>
</issue_57339>
<issue_57333>
<issue_url>https://redmine.bilendi.com/issues/57333</issue_url>
</issue_57333>
<issue_57332>
<issue_url>https://redmine.bilendi.com/issues/57332</issue_url>
</issue_57332>
<issue_57269>
<issue_url>https://redmine.bilendi.com/issues/57269</issue_url>
</issue_57269>
</journals>
