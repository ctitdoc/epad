<journals>
<issue_67699>
<issue_url>https://redmine.bilendi.com/issues/67699</issue_url>
</issue_67699>
<issue_67698>
<issue_url>https://redmine.bilendi.com/issues/67698</issue_url>
</issue_67698>
<issue_67697>
<issue_url>https://redmine.bilendi.com/issues/67697</issue_url>
</issue_67697>
<issue_67696>
<issue_url>https://redmine.bilendi.com/issues/67696</issue_url>
</issue_67696>
<issue_67695>
<issue_url>https://redmine.bilendi.com/issues/67695</issue_url>
</issue_67695>
<issue_67693>
<issue_url>https://redmine.bilendi.com/issues/67693</issue_url>
</issue_67693>
<issue_67692>
<issue_url>https://redmine.bilendi.com/issues/67692</issue_url>
</issue_67692>
<issue_67691>
<issue_url>https://redmine.bilendi.com/issues/67691</issue_url>
</issue_67691>
<issue_67690>
<issue_url>https://redmine.bilendi.com/issues/67690</issue_url>
</issue_67690>
<issue_67689>
<issue_url>https://redmine.bilendi.com/issues/67689</issue_url>
</issue_67689>
<issue_67688>
<issue_url>https://redmine.bilendi.com/issues/67688</issue_url>
</issue_67688>
<issue_67687>
<issue_url>https://redmine.bilendi.com/issues/67687</issue_url>
</issue_67687>
<issue_67686>
<issue_url>https://redmine.bilendi.com/issues/67686</issue_url>
</issue_67686>
<issue_67649>
<issue_url>https://redmine.bilendi.com/issues/67649</issue_url>
</issue_67649>
<issue_67642>
<issue_url>https://redmine.bilendi.com/issues/67642</issue_url>
</issue_67642>
<issue_67641>
<issue_url>https://redmine.bilendi.com/issues/67641</issue_url>
</issue_67641>
<issue_67640>
<issue_url>https://redmine.bilendi.com/issues/67640</issue_url>
</issue_67640>
<issue_67630>
<issue_url>https://redmine.bilendi.com/issues/67630</issue_url>
</issue_67630>
<issue_67629>
<issue_url>https://redmine.bilendi.com/issues/67629</issue_url>
</issue_67629>
<issue_67628>
<issue_url>https://redmine.bilendi.com/issues/67628</issue_url>
</issue_67628>
<issue_67626>
<issue_url>https://redmine.bilendi.com/issues/67626</issue_url>
</issue_67626>
<issue_67625>
<issue_url>https://redmine.bilendi.com/issues/67625</issue_url>
</issue_67625>
<issue_67624>
<issue_url>https://redmine.bilendi.com/issues/67624</issue_url>
</issue_67624>
<issue_67622>
<issue_url>https://redmine.bilendi.com/issues/67622</issue_url>
</issue_67622>
<issue_67621>
<issue_url>https://redmine.bilendi.com/issues/67621</issue_url>
</issue_67621>
<issue_67618>
<issue_url>https://redmine.bilendi.com/issues/67618</issue_url>
</issue_67618>
<issue_67604>
<issue_url>https://redmine.bilendi.com/issues/67604</issue_url>
</issue_67604>
<issue_67603>
<issue_url>https://redmine.bilendi.com/issues/67603</issue_url>
</issue_67603>
<issue_67595>
<issue_url>https://redmine.bilendi.com/issues/67595</issue_url>
</issue_67595>
<issue_67586>
<issue_url>https://redmine.bilendi.com/issues/67586</issue_url>
</issue_67586>
<issue_67565>
<issue_url>https://redmine.bilendi.com/issues/67565</issue_url>
</issue_67565>
<issue_67517>
<issue_url>https://redmine.bilendi.com/issues/67517</issue_url>
</issue_67517>
<issue_67516>
<issue_url>https://redmine.bilendi.com/issues/67516</issue_url>
</issue_67516>
<issue_67515>
<issue_url>https://redmine.bilendi.com/issues/67515</issue_url>
</issue_67515>
<issue_67493>
<issue_url>https://redmine.bilendi.com/issues/67493</issue_url>
</issue_67493>
<issue_67489>
<issue_url>https://redmine.bilendi.com/issues/67489</issue_url>
</issue_67489>
<issue_67443>
<issue_url>https://redmine.bilendi.com/issues/67443</issue_url>
</issue_67443>
<issue_67439>
<issue_url>https://redmine.bilendi.com/issues/67439</issue_url>
</issue_67439>
<issue_67430>
<issue_url>https://redmine.bilendi.com/issues/67430</issue_url>
</issue_67430>
<issue_67411>
<issue_url>https://redmine.bilendi.com/issues/67411</issue_url>
</issue_67411>
<issue_67409>
<issue_url>https://redmine.bilendi.com/issues/67409</issue_url>
</issue_67409>
<issue_67407>
<issue_url>https://redmine.bilendi.com/issues/67407</issue_url>
</issue_67407>
<issue_67402>
<issue_url>https://redmine.bilendi.com/issues/67402</issue_url>
</issue_67402>
<issue_67395>
<issue_url>https://redmine.bilendi.com/issues/67395</issue_url>
</issue_67395>
<issue_67387>
<issue_url>https://redmine.bilendi.com/issues/67387</issue_url>
</issue_67387>
<issue_67384>
<issue_url>https://redmine.bilendi.com/issues/67384</issue_url>
</issue_67384>
<issue_67322>
<issue_url>https://redmine.bilendi.com/issues/67322</issue_url>
</issue_67322>
<issue_67315>
<issue_url>https://redmine.bilendi.com/issues/67315</issue_url>
</issue_67315>
<issue_67311>
<issue_url>https://redmine.bilendi.com/issues/67311</issue_url>
</issue_67311>
<issue_67308>
<issue_url>https://redmine.bilendi.com/issues/67308</issue_url>
</issue_67308>
<issue_67298>
<issue_url>https://redmine.bilendi.com/issues/67298</issue_url>
</issue_67298>
<issue_67280>
<issue_url>https://redmine.bilendi.com/issues/67280</issue_url>
</issue_67280>
<issue_67248>
<issue_url>https://redmine.bilendi.com/issues/67248</issue_url>
</issue_67248>
<issue_67188>
<issue_url>https://redmine.bilendi.com/issues/67188</issue_url>
<journal id="638644">
  <user id="529" name="Franck D."/>
  <notes>fyi j'ai repassé la card en waiting à la main car elle était resté dans la colonne trello "Done/TESTING" malgrè le move en ToPlan de Gé (cf cmt précédent).</notes>
  <created_on>2021-06-09T06:31:30Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="639188">
  <user id="529" name="Franck D."/>
  <notes>MET DONE NOW</notes>
  <created_on>2021-06-11T13:02:12Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="assigned_to_id">
      <old_value>441</old_value>
      <new_value>355</new_value>
    </detail>
  </details>
</journal>
<journal id="639356">
  <user id="529" name="Franck D."/>
  <notes>ce tkt repasse todo pour le run de chgt "sf 4 migration anticipation" statué aujourd'hui avec la team migration sf4.</notes>
  <created_on>2021-06-14T13:20:46Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="639357">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-14T13:21:07Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>8</old_value>
      <new_value>2</new_value>
    </detail>
  </details>
</journal>
<journal id="640151">
  <user id="529" name="Franck D."/>
  <notes>retour de review : 
* la résolution des conflit du composer.lock a le même bug que celui décrit dans #66686#note-54 : {{collapse()
&lt;pre&gt;
        {
            "name": "phar-io/version",
            "version": "3.1.0",
            "source": {
                "type": "git",
                "url": "https://github.com/phar-io/version.git",
                "reference": "bae7c545bef187884426f042434e561ab1ddb182"
            },
            "dist": {
                "type": "zip",
                "url": "https://api.github.com/repos/phar-io/version/zipball/bae7c545bef187884426f042434e561ab1ddb182",
                "reference": "bae7c545bef187884426f042434e561ab1ddb182",
                "shasum": ""
            },
            "require": {
                "php": "^7.2 || ^8.0"
            },
            "type": "library",
            "autoload": {
                "classmap": [
                    "src/"
                ]
            },
            "notification-url": "https://packagist.org/downloads/",
            "license": [
                "BSD-3-Clause"
            ],
            "authors": [
                {
                    "name": "Arne Blankerts",
                    "email": "arne@blankerts.de",
                    "role": "Developer"
                },
                {
                    "name": "Sebastian Heuer",
                    "email": "sebastian@phpeople.de",
                    "role": "Developer"
                },
                {
                    "name": "Sebastian Bergmann",
                    "email": "sebastian@phpunit.de",
                    "role": "Developer"
                }
            ],
            "description": "Allows to configure dependency injection using annotations",
            "homepage": "http://jmsyst.com/bundles/JMSDiExtraBundle",
            "keywords": [
                "annotations",
                "dependency injection"
            ],
            "time": "2018-01-12T19:04:30+00:00"
        },

&lt;/pre&gt;
}}
** cf les champs description et homepage qui sont ceux d'un autre package JMSDiExtraBundle et non ceux de ce package phar-io/version;

Il faut donc effectuer une correction similaire à celle décrite dans cette note (faire un backup de sa branche avant de faire les git reset --hard qui peuvent induire une perte de données/blocage si pas fait correctement... me demander si on est pas sûr de son coup).</notes>
  <created_on>2021-06-17T14:27:05Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640152">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-17T14:27:31Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>20</old_value>
      <new_value>2</new_value>
    </detail>
  </details>
</journal>
<journal id="640218">
  <user id="529" name="Franck D."/>
  <notes>les TU sont OK suite à la résolution du bug en note #67188#note-39 : {{collapse()
&lt;pre&gt;
/usr/bin/php /home/parallels/dev/apps/ddi/vendor/phpunit/phpunit/phpunit --configuration /home/parallels/dev/apps/ddi/phpunit.xml.dist /home/parallels/dev/apps/ddi/tests --teamcity
Testing started at 10:38 AM ...
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.

Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!



Time: 00:17.491, Memory: 73.00 MB

OK (2 tests, 9 assertions)

Remaining deprecation notices (112)

  15x: Bundle inheritance is deprecated as of 3.4 and will be removed in 4.0.
    6x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    3x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    3x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    3x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Import\DirectorCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\IntegrityCheckerCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "FOS\JsRoutingBundle\Command\RouterDebugExposedCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "FOS\JsRoutingBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "JMS\TranslationBundle\Command\ResourcesListCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "JMS\TranslationBundle\Command\ExtractTranslationCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Util\DatabaseNameCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Import\RegionalDirectorateDepartmentCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Import\AccountPointsCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\AllMultiProductDeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\ValidEarnMemberReachedTheirQuotasCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\DeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\NewEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\SendEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\DebugCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\WatchCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\SwaggerDumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: getEntityManager is deprecated since Symfony 2.1. Use getManager instead
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Symfony\Bundle\FrameworkBundle\Command\RouterDebugCommand::__construct() expects an instance of "Symfony\Component\Routing\RouterInterface" as first argument since Symfony 3.4. Not passing it is deprecated and will throw a TypeError in 4.0.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Calling Doctrine\ORM\EntityManager::flush() with any arguments to flush specific entities is deprecated and will not be supported in Doctrine ORM 3.0.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  2x: The "Doctrine\Common\Inflector\Inflector::classify" method is deprecated and will be dropped in doctrine/inflector 2.0. Please update to the new Inflector API.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  2x: The "app.file.export.ftp" service is private, getting it from the container is deprecated since Symfony 3.2 and will fail in 4.0. You should either make the service public, or stop using the container directly and use dependency injection instead.
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  1x: Autowiring services based on the types they implement is deprecated since Symfony 3.3 and won't be supported in version 4.0. Try changing the type-hint for argument "$earnManager" of method "Tests\DataFixtures\ORM\LoadEarnData::__construct()" to "Bilendi\EarningBundle\EarnManagerInterface" instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_BaseNodeVisitor" class is deprecated since Twig version 2.7, use "Twig\NodeVisitor\AbstractNodeVisitor" instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_RuntimeLoaderInterface" class is deprecated since Twig version 2.7, use "Twig\RuntimeLoader\RuntimeLoaderInterface" instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The Symfony\Component\ClassLoader\ClassLoader class is deprecated since Symfony 3.3 and will be removed in 4.0. Use Composer instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "form_login" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "guard" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the KERNEL_DIR environment variable or the automatic guessing based on the phpunit.xml / phpunit.xml.dist file location is deprecated since Symfony 3.4. Set the KERNEL_CLASS environment variable to the fully-qualified class name of your Kernel instead. Not setting the KERNEL_CLASS environment variable will throw an exception on 4.0 unless you override the :createKernel() or :getKernelClass() method.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

Process finished with exit code 1

&lt;/pre&gt;

(les warning de deprecated sf 4 de ce TU sont gérés dans le cadre du tkt de migration sf4).
}}</notes>
  <created_on>2021-06-17T17:25:33Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="640302">
  <user id="529" name="Franck D."/>
  <notes>{{collapse(unit test ok after branches refactoring)
&lt;pre&gt;
/usr/bin/php /home/parallels/dev/apps/ddi/vendor/phpunit/phpunit/phpunit --configuration /home/parallels/dev/apps/ddi/phpunit.xml.dist /home/parallels/dev/apps/ddi/tests --teamcity
Testing started at 5:44 AM ...
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.

Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!



Time: 00:23.400, Memory: 75.00 MB

OK (2 tests, 9 assertions)

Remaining deprecation notices (112)

  15x: Bundle inheritance is deprecated as of 3.4 and will be removed in 4.0.
    6x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    3x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    3x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    3x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Import\DirectorCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\IntegrityCheckerCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "FOS\JsRoutingBundle\Command\RouterDebugExposedCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "FOS\JsRoutingBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "JMS\TranslationBundle\Command\ResourcesListCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "JMS\TranslationBundle\Command\ExtractTranslationCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Util\DatabaseNameCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Import\RegionalDirectorateDepartmentCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Import\AccountPointsCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\AllMultiProductDeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\ValidEarnMemberReachedTheirQuotasCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "AppBundle\Command\Cron\DeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\NewEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\SendEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\DebugCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\WatchCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\SwaggerDumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: getEntityManager is deprecated since Symfony 2.1. Use getManager instead
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  4x: Symfony\Bundle\FrameworkBundle\Command\RouterDebugCommand::__construct() expects an instance of "Symfony\Component\Routing\RouterInterface" as first argument since Symfony 3.4. Not passing it is deprecated and will throw a TypeError in 4.0.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Calling Doctrine\ORM\EntityManager::flush() with any arguments to flush specific entities is deprecated and will not be supported in Doctrine ORM 3.0.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  2x: The "Doctrine\Common\Inflector\Inflector::classify" method is deprecated and will be dropped in doctrine/inflector 2.0. Please update to the new Inflector API.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  2x: The "app.file.export.ftp" service is private, getting it from the container is deprecated since Symfony 3.2 and will fail in 4.0. You should either make the service public, or stop using the container directly and use dependency injection instead.
    1x in StreamlineExportCommandTest::testCommand from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  1x: Autowiring services based on the types they implement is deprecated since Symfony 3.3 and won't be supported in version 4.0. Try changing the type-hint for argument "$earnManager" of method "Tests\DataFixtures\ORM\LoadEarnData::__construct()" to "Bilendi\EarningBundle\EarnManagerInterface" instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_BaseNodeVisitor" class is deprecated since Twig version 2.7, use "Twig\NodeVisitor\AbstractNodeVisitor" instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_RuntimeLoaderInterface" class is deprecated since Twig version 2.7, use "Twig\RuntimeLoader\RuntimeLoaderInterface" instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The Symfony\Component\ClassLoader\ClassLoader class is deprecated since Symfony 3.3 and will be removed in 4.0. Use Composer instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "form_login" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "guard" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the KERNEL_DIR environment variable or the automatic guessing based on the phpunit.xml / phpunit.xml.dist file location is deprecated since Symfony 3.4. Set the KERNEL_CLASS environment variable to the fully-qualified class name of your Kernel instead. Not setting the KERNEL_CLASS environment variable will throw an exception on 4.0 unless you override the :createKernel() or :getKernelClass() method.
    1x in StreamlineExportCommandTest::setUp from Tests\AppBundle\Command\Cron

Process finished with exit code 1

&lt;/pre&gt;
}}

(deprecated are managed in the sf4 migration ticket (in wip))</notes>
  <created_on>2021-06-18T12:48:22Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640342">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:34:04Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="relates">
      <old_value>66686</old_value>
      <new_value/>
    </detail>
  </details>
</journal>
<journal id="640344">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:34:13Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocked">
      <old_value/>
      <new_value>66686</new_value>
    </detail>
  </details>
</journal>
<journal id="640364">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T16:52:00Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>[DDI] souhaite un nouvel export qui comporte tous les mouvements de points. 1 ligne = 1 mouvement. 
L'export comporte les crédits et les débits. Si le débit est une commande il est attendu le numéro correspondant.

L'export inclus les mouvements de la veille se baser sur date.gain pour ne prednre en compte que les points 'utilisables' donc &lt;&gt; gains.valid = 'A' 


|_.Titre   |_.Objet   |_.VALEUR|
|  Client VIP   |Client VIP     |Numéro|
|  Mois |Mois du crédit/ débit |sous le format 2 caractères (01, 12)|
|  Commande |Commande      |(Si acquis via commande ) Le num de commande qui correspond au débit ? si plusieurs commandes plusieurs lignes ?|
| Points  |Mouvement Points     |Crédit en + et débit en -, une ligne par mouvement|
| Date de début de validité  |Date de début de validité    |champs non obligatoire non renseigné pour un débit. NB pour les crédit dans le passé sur un programme antérieur renseigné par défaut le 01/01 de l'année concernée  |
| Date de fin de validité   |Date de fin de validité    |champs non obligatoire non renseigné pour un débit |

*Spécifique* : doit exclure les points pending et prévoir un rattrapage dès lors que les points change de statut et son utilisable par le membre VIP (300 europoints ou 8 générateurs sur le programme concerné)
Fréquence quotidienne

Il est attendu 2 fichiers similaires qui seront déposés sur le même SFTP dans 2 dossiers distincts


Dépôt sur le SFTP (SFTP client info dans le ticket parent)
Prod :
SAP/Points
CRM/Points

Testing:
SAP/Points
CRM/Points


Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année 

Edit 30/04/2021 : Date début = dategain  et Date Fin = Date_expiration_miles</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

[DDI] souhaite un nouvel export qui comporte tous les mouvements de points. 1 ligne = 1 mouvement. 
L'export comporte les crédits et les débits. Si le débit est une commande il est attendu le numéro correspondant.

L'export inclus les mouvements de la veille se baser sur date.gain pour ne prednre en compte que les points 'utilisables' donc &lt;&gt; gains.valid = 'A' 


|_.Titre   |_.Objet   |_.VALEUR|
|  Client VIP   |Client VIP     |Numéro|
|  Mois |Mois du crédit/ débit |sous le format 2 caractères (01, 12)|
|  Commande |Commande      |(Si acquis via commande ) Le num de commande qui correspond au débit ? si plusieurs commandes plusieurs lignes ?|
| Points  |Mouvement Points     |Crédit en + et débit en -, une ligne par mouvement|
| Date de début de validité  |Date de début de validité    |champs non obligatoire non renseigné pour un débit. NB pour les crédit dans le passé sur un programme antérieur renseigné par défaut le 01/01 de l'année concernée  |
| Date de fin de validité   |Date de fin de validité    |champs non obligatoire non renseigné pour un débit |

*Spécifique* : doit exclure les points pending et prévoir un rattrapage dès lors que les points change de statut et son utilisable par le membre VIP (300 europoints ou 8 générateurs sur le programme concerné)
Fréquence quotidienne

Il est attendu 2 fichiers similaires qui seront déposés sur le même SFTP dans 2 dossiers distincts


Dépôt sur le SFTP (SFTP client info dans le ticket parent)
Prod :
SAP/Points
CRM/Points

Testing:
SAP/Points
CRM/Points


Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année 

Edit 30/04/2021 : Date début = dategain  et Date Fin = Date_expiration_miles

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement


Lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828
php bin/console app:cron:streamline-export (a brancher quotidiennement)

Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</old_value>
      <new_value>https://gitlab.bilendi.net/dev/ddi/-/merge_requests/842

LIRE: https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

CRON :
php bin/console app:cron:streamline-export (a brancher quotidiennement)


OBSOLETE (forget me): 
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828

[OBSOLETE (forget me): 
Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</new_value>
    </detail>
  </details>
</journal>
<journal id="640366">
  <user id="529" name="Franck D."/>
  <notes>met des dernières correction + réorg de gestion de branche/code avec #66686  voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</notes>
  <created_on>2021-06-18T16:59:46Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="assigned_to_id">
      <old_value>355</old_value>
      <new_value>441</new_value>
    </detail>
    <detail property="attr" name="status_id">
      <old_value>2</old_value>
      <new_value>8</new_value>
    </detail>
  </details>
</journal>
<journal id="640375">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:11:20Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/merge_requests/842

LIRE: https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

CRON :
php bin/console app:cron:streamline-export (a brancher quotidiennement)


OBSOLETE (forget me): 
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828

[OBSOLETE (forget me): 
Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

https://gitlab.bilendi.net/dev/ddi/-/merge_requests/842


CRON :
php bin/console app:cron:streamline-export (a brancher quotidiennement)


OBSOLETE (forget me): 
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828

[OBSOLETE (forget me): 
Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</new_value>
    </detail>
  </details>
</journal>
<journal id="640377">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:12:03Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

https://gitlab.bilendi.net/dev/ddi/-/merge_requests/842


CRON :
php bin/console app:cron:streamline-export (a brancher quotidiennement)


OBSOLETE (forget me): 
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828

[OBSOLETE (forget me): 
Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/842

CRON :
php bin/console app:cron:streamline-export (a brancher quotidiennement)


OBSOLETE (forget me): 
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828

[OBSOLETE (forget me): 
Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</new_value>
    </detail>
  </details>
</journal>
<journal id="640380">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:13:11Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/842

CRON :
php bin/console app:cron:streamline-export (a brancher quotidiennement)


OBSOLETE (forget me): 
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828

[OBSOLETE (forget me): 
Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/842

CRON :
php bin/console app:cron:streamline-export (a brancher quotidiennement)


OBSOLETE (forget me): 
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/828

OBSOLETE (forget me): 
Cette branche inclue les les changement de #66686 qui permet de faire un environnement. Pour regarder le code specifique a cette branche il faut regarder le dernier commit uniquement</new_value>
    </detail>
  </details>
</journal></issue_67188>
<issue_67156>
<issue_url>https://redmine.bilendi.com/issues/67156</issue_url>
</issue_67156>
<issue_67154>
<issue_url>https://redmine.bilendi.com/issues/67154</issue_url>
</issue_67154>
<issue_67138>
<issue_url>https://redmine.bilendi.com/issues/67138</issue_url>
</issue_67138>
<issue_67084>
<issue_url>https://redmine.bilendi.com/issues/67084</issue_url>
<journal id="638287">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-07T12:05:57Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="relates">
      <old_value/>
      <new_value>68616</new_value>
    </detail>
  </details>
</journal>
<journal id="638290">
  <user id="529" name="Franck D."/>
  <notes>cf note #67084#note-30.</notes>
  <created_on>2021-06-07T12:07:22Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>20</old_value>
      <new_value>6</new_value>
    </detail>
  </details>
</journal>
<journal id="638328">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-07T14:27:30Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="fixed_version_id">
      <old_value>1467</old_value>
      <new_value>833</new_value>
    </detail>
  </details>
</journal></issue_67084>
<issue_67075>
<issue_url>https://redmine.bilendi.com/issues/67075</issue_url>
</issue_67075>
<issue_67042>
<issue_url>https://redmine.bilendi.com/issues/67042</issue_url>
</issue_67042>
<issue_67041>
<issue_url>https://redmine.bilendi.com/issues/67041</issue_url>
</issue_67041>
<issue_67039>
<issue_url>https://redmine.bilendi.com/issues/67039</issue_url>
</issue_67039>
<issue_67017>
<issue_url>https://redmine.bilendi.com/issues/67017</issue_url>
</issue_67017>
<issue_67006>
<issue_url>https://redmine.bilendi.com/issues/67006</issue_url>
</issue_67006>
<issue_66987>
<issue_url>https://redmine.bilendi.com/issues/66987</issue_url>
</issue_66987>
<issue_66986>
<issue_url>https://redmine.bilendi.com/issues/66986</issue_url>
</issue_66986>
<issue_66956>
<issue_url>https://redmine.bilendi.com/issues/66956</issue_url>
</issue_66956>
<issue_66937>
<issue_url>https://redmine.bilendi.com/issues/66937</issue_url>
</issue_66937>
<issue_66928>
<issue_url>https://redmine.bilendi.com/issues/66928</issue_url>
</issue_66928>
<issue_66922>
<issue_url>https://redmine.bilendi.com/issues/66922</issue_url>
</issue_66922>
<issue_66917>
<issue_url>https://redmine.bilendi.com/issues/66917</issue_url>
</issue_66917>
<issue_66865>
<issue_url>https://redmine.bilendi.com/issues/66865</issue_url>
</issue_66865>
<issue_66823>
<issue_url>https://redmine.bilendi.com/issues/66823</issue_url>
</issue_66823>
<issue_66815>
<issue_url>https://redmine.bilendi.com/issues/66815</issue_url>
</issue_66815>
<issue_66730>
<issue_url>https://redmine.bilendi.com/issues/66730</issue_url>
</issue_66730>
<issue_66729>
<issue_url>https://redmine.bilendi.com/issues/66729</issue_url>
</issue_66729>
<issue_66722>
<issue_url>https://redmine.bilendi.com/issues/66722</issue_url>
</issue_66722>
<issue_66721>
<issue_url>https://redmine.bilendi.com/issues/66721</issue_url>
</issue_66721>
<issue_66689>
<issue_url>https://redmine.bilendi.com/issues/66689</issue_url>
</issue_66689>
<issue_66686>
<issue_url>https://redmine.bilendi.com/issues/66686</issue_url>
<journal id="638643">
  <user id="529" name="Franck D."/>
  <notes>fyi j'ai repassé la card en waiting à la main car elle était resté dans la colonne trello "Done/TESTING" malgrè le move en ToPlan de Gé (cf cmt précédent).</notes>
  <created_on>2021-06-09T06:30:38Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="639186">
  <user id="529" name="Franck D."/>
  <notes>MET DONE NOW</notes>
  <created_on>2021-06-11T13:01:38Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="assigned_to_id">
      <old_value>355</old_value>
      <new_value>441</new_value>
    </detail>
  </details>
</journal>
<journal id="639231">
  <user id="529" name="Franck D."/>
  <notes>... l'obsolescence du jms translation bundle faisait planter l'extraction des clés lors du pipelinede met, car ne supportait le parsing php que jusqu'en php 7.0 : le 'composer update' du jms translation bundle et commit dans la branche testing de la nouvelle version produite du composer.lock a résolu ce bug, cf :
https://gitlab.bilendi.net/dev/ddi/-/commit/adfec9a2840724f22277ca456779b9535a541fda</notes>
  <created_on>2021-06-11T15:25:01Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="639354">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-14T13:19:41Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>8</old_value>
      <new_value>2</new_value>
    </detail>
    <detail property="attr" name="assigned_to_id">
      <old_value>441</old_value>
      <new_value>355</new_value>
    </detail>
  </details>
</journal>
<journal id="639355">
  <user id="529" name="Franck D."/>
  <notes>ce tkt repasse todo pour le run de chgt "sf 4 migration anticipation" statué aujourd'hui avec la team migration sf4.</notes>
  <created_on>2021-06-14T13:19:41Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="639856">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-16T12:07:02Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attachment" name="99023">
      <old_value/>
      <new_value>Capture d’écran 2021-06-16 à 10.45.10.png</new_value>
    </detail>
  </details>
</journal>
<journal id="639857">
  <user id="529" name="Franck D."/>
  <notes>Voilà ci-dessous mon CR de review du changement #66686#note-50 et des décisions/actions consécutives exécutées.

* Identification des éventuel chgt de code spécifiques à ce tkt lors de ce merge :
** la merge request indique ce commit de merge : https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827/diffs?commit_id=53e08b48769f9be1d7c410b439466c97f645e284 ;
** cette vue de commit ne montre pas la séquence de commit de Seb (cf "ses merge request et branche dédiés":https://gitlab.bilendi.net/dev/ddi/-/merge_requests/840) récupérés dans la branche de ce tkt (issue-66686), via ce commit de merge, ni les éventuel chgt spécifiques commités pour résoudre les conflit indiqués en #66686#note-50 (qui ne décrit pas non plus ces éventuels chgt de résolution de conflit...);
** via une contre-vérif "git log -p -cc" de la branche issue-66686, on voit :
*** les commit flaggués "ref #68520" de Seb, 
*** les zones de code, dans les diffs du commit de merge (visibles via l'option -cc), avec de potentielles résolutions de conflit effectuées (car elles ont des diff + et - très contigus de commits des deux branches mergées : exemple : {{collapse()
&lt;pre&gt;

     32 -         "bilendi/back-office-bundle": "^1.11.1", =&gt; issue-66686
     33 +         "bilendi/back-office-bundle": "^1.12.1", =&gt; master
     

&lt;/pre&gt;
}}
*** au final, il n'apparait pas de chgt direct sur les chgt de code fait pour cette évol pour résoudre ces conflit, pour autant de tels chgt des packages "sous-jacent" à l'exécution du code ddi tel que celui de cette évol, nécessite l'exécution des TU de l'app (dont celui de l'évol), pour vérifier la non régression de l'évol, mais aussi d'éventuelles autres parties de code testées;
* Vérification de l'exécution des TU :
** Aucune trace ou argumentation de résultat de test de couverture de ce changement dans #66686#note-50;
** ... vérification du test report du pipeline de merge : &lt;pre&gt;

$ SYMFONY_DEPRECATIONS_HELPER=disabled ./vendor/bin/phpunit
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.
Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!
.IIIIII                                                             7 / 7 (100%)
Time: 00:00.320, Memory: 30.50 MB
OK, but incomplete, skipped, or risky tests!
Tests: 7, Assertions: 3, Incomplete: 6.
&lt;/pre&gt;
** en français après décodage : 7 méthodes de test exécutées, 6 incomplètes (et donc ignorées), 3 assertions (de l'unique méthode de test exécutée donc) ok =&gt; c'est quand même compliqué de valider la non regression qu'avec ça ... après vérif du code de test :
*** c'est bien le test de l'évol qui est exécuté et ok;
*** les 6 autres méthodes de test du "process de déclaration" (script ProcessDeclarationServiceTest.php), ont été marquées comme "incomplètes" dans cette branche issue-66686, et du coup ne sont pas jouées =&gt; ça mérite des explications ça quand même...
*** après discussion (pas très pro active)... et donc surtout des déduction perso en soirée... la raison serait :
*** que pour tester l'évol de ce tkt, on a rajouté dans sa branche issue-66686, un test unitaire =&gt; +1 !
*** mais que comme le framework de test n'était pas déjà configuré pour cette app, il a fallu le faire pour pouvoir rajouter ce test unitaire =&gt; +1 aussi : sauf arbitrage moe/leads de délais/ressources =&gt; il faut créer les composant manquant d'une app quand il y en a le besoin =&gt; et après ça servira pour les autres tkt =&gt; encore +1 !
*** par ailleurs il existe aussi dans ce script de test unitaire du "process de déclaration" : ProcessDeclarationServiceTest.php;
*** et il ne fonctionne pas en l'état car ... il test du code qui n'existe pas (le script ProcessDeclarationService.php) ! =&gt; si ça ça mérite pas aussi des explication...;
*** le seul indice laissé dans le commit de désactivation du script de test ProcessDeclarationServiceTest.php est : 'to fix in #59349' =&gt; vive le jeu de piste !
*** ... et la poursuite de cette "piste" plus tard en soirée est en matinée conclue à :
*** la branche du tkt #59349 ajoute le script ProcessDeclarationService.php, mais n'est à priori à date pas mep vu que ce script n'existe pas dans master à date,
*** et ce message laconique 'to fix in #59349' veut donc dire qu'il faudra ré-activer le script de test ProcessDeclarationServiceTest.php, dans le cadre du tkt #59349, lorsque celui-ci sera à mep (pour autant les deux tkt n'ont pas été liés ni de cmt sur ce poitn dans #59349, donc je me demande comment le dev qui va mep #59349 sera  aware de ça...);
*** mais en fait... après vérif encore plus tard en matinée... ce script ProcessDeclarationService.php ne sera jamais mep car il a été supprimé et donc son script de test ProcessDeclarationServiceTest.php est en fait obsolete !
*** comment j'ai déduis ça :
*** d'après la mr de #59349, la branche issue-59349 contenant le script ProcessDeclarationService.php a été mergée dans une branche "v2" puis supprimée,
*** mais cette branche 'v2' ne contient pas/plus ce script ProcessDeclarationService.php (et a été mergée),
*** et cette contre-vérif dans git (sur master mais aussi testing) : {{collapse()
&lt;pre&gt;
parallels@debian-gnu-linux-10:~/dev/apps/ddi$ git log -p --all --full-history -- "**/ProcessDeclarationService.php"
commit d995942d5e986e558779d8f5846921968b972cde
Merge: 0d73a548 475aed5c
Author: Marc Giraud-Telme &lt;m.giraudtelme@bilendi.com&gt;
Date:   Tue Jun 30 10:24:16 2020 +0200

    Merge branch 'master' into issue-59926

... et après divers commit de merge :

commit d40547d6dbebea180fe6e9c3336cfddaf3f33461
Author: Éric Lernon &lt;e.lernon@bilendi.com&gt;
Date:   Fri Jan 3 18:45:32 2020 +0100

    ref#59349 rewrite the way we check when member earn should move to validated

diff --git a/src/AppBundle/Services/ProcessDeclarationService.php b/src/AppBundle/Services/ProcessDeclarationService.php
deleted file mode 100644
index 71b09c90..00000000
--- a/src/AppBundle/Services/ProcessDeclarationService.php
+++ /dev/null
@@ -1,81 +0,0 @@
-&lt;?php
-
-namespace AppBundle\Services;
-
-use AppBundle\Entity\Company;
-use AppBundle\Entity\Declaration;
-use AppBundle\Entity\DeclarationProduct;
-use AppBundle\Entity\Repository\DeclarationRepository;
-use Bilendi\EarningBundle\EarnManager;
-use Doctrine\ORM\EntityManager;
-use AppBundle\Entity\Repository\CompanyRepository;
-
-class ProcessDeclarationService
-{
-    /**
-     * @var EarnManager
-     */
-    protected $earnManager;
-

...

&lt;/pre&gt;
}}
*** confirme que ce script a été supprimé en janvier 2018, et son script de test n'ayant pas été modifié depuis 2 ans (cf screenshot attaché) =&gt; il est également de fait obsolete;
* Décisions/actions consécutives :
** ProcessDeclarationServiceTest.php a été supprimé dans cette branche;
** la vérif de l'exécution des test unitaires dans le pipeline est ok : {{collapse()
&lt;pre&gt;
$ SYMFONY_DEPRECATIONS_HELPER=disabled ./vendor/bin/phpunit
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.
Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!
.                                                                   1 / 1 (100%)
Time: 00:00.331, Memory: 30.50 MB
OK (1 test, 3 assertions)
&lt;/pre&gt;
}}
** ce test report ne contient plus ces 'incomplete tests' obsoletes.</notes>
  <created_on>2021-06-16T12:07:02Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="639923">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-16T15:14:46Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attachment" name="99036">
      <old_value/>
      <new_value>Capture d’écran 2021-06-16 à 16.30.07.png</new_value>
    </detail>
  </details>
</journal>
<journal id="639924">
  <user id="529" name="Franck D."/>
  <notes>... le merge de MET remonte ce conflit : {{collapse()
&lt;pre&gt;
{
            "name": "phar-io/version",
            "version": "3.1.0",
            "source": {
                "type": "git",
                "url": "https://github.com/phar-io/version.git",
                "reference": "bae7c545bef187884426f042434e561ab1ddb182"
            },
            "dist": {
                "type": "zip",
                "url": "https://api.github.com/repos/phar-io/version/zipball/bae7c545bef187884426f042434e561ab1ddb182",
                "reference": "bae7c545bef187884426f042434e561ab1ddb182",
                "shasum": ""
            },
            "require": {
                "php": "^7.2 || ^8.0"
            },
            "type": "library",
            "autoload": {
                "classmap": [
                    "src/"
                ]
            },
            "notification-url": "https://packagist.org/downloads/",
            "license": [
                "BSD-3-Clause"
            ],
            "authors": [
                {
                    "name": "Arne Blankerts",
                    "email": "arne@blankerts.de",
                    "role": "Developer"
                },
                {
                    "name": "Sebastian Heuer",
                    "email": "sebastian@phpeople.de",
                    "role": "Developer"
                },
                {
                    "name": "Sebastian Bergmann",
                    "email": "sebastian@phpunit.de",
                    "role": "Developer"
                }
            ],
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
            "description": "Library for handling version information and constraints",
            "time": "2021-02-23T14:00:09+00:00"
=======
            "description": "Allows to configure dependency injection using annotations",
            "homepage": "http://jmsyst.com/bundles/JMSDiExtraBundle",
            "keywords": [
                "annotations",
                "dependency injection"
            ],
            "time": "2018-01-12T19:04:30+00:00"
&gt;&gt;&gt;&gt;&gt;&gt;&gt; origin/issue-66686
        },
&lt;/pre&gt;
}}
Il y a forcément un bug quelque part dans la branche issue-66686 car cf :  https://packagist.org/packages/phar-io/version : sa description ne peut pas être : "Allows to configure dependency injection using annotations", ni sa homepage :  "http://jmsyst.com/bundles/JMSDiExtraBundle" =&gt; ça se sont des infos d'un autre package =&gt; donc ce bug intervertissant ces champs entre ces deux packages doit être dans l'un des commmit de l'historique de commit de ce fichier composer.lock;
le screenshot attaché en note #66686#note-53 montre que c'est lors du merge de master (cf no de commit dans le screenshot), probablement lors de la résolution des conflit de merge de #66686#note-50;
du coup y a guère d'autres choix que de revert ce commit de merge et de le refaire, je fais ça dans le cadre de cette review...</notes>
  <created_on>2021-06-16T15:14:46Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640064">
  <user id="529" name="Franck D."/>
  <notes>La résolution du bug de la note précédente est done :
* reset du commit de merge et du commit de suppression du script de test unitaire ProcessDeclarationServiceTest.php décrit dans la note précédente;
** _NB : il faut utiliser l'option -f lors du push de la branche resetée sinon gitlab refuse de la pousser vu qu'elle devient à cause de ces reset, en retard de commit par rapport à sa version dans le repo origin_
* nouveau merge de master avec résolution correcte des conflit du composer.lock, et application d'autres correctif pour les autres regressions induites par ce merge :
** suite au plantage de la résolution de deps par le composer install, suppression de double version dans le composer.lock, de packages 'phar' requis par phpunit =&gt; possiblement du au fait que les deux branches ont commités chacun pour leur propre besoin des version de phpunit différentes =&gt; on a gardé les version les plus récentes de ces pkg et le TU est passé...
** correction d'un passage d'argument dans un cron que phpstan refuse lors du deploy_dev.sh (ça le faisait pas avnt) =&gt; on suppose que ça vient de l'update de version phpstan liée à ce merge =&gt; la solus est de caster l'argument en string;
* cf le commit de ces chgt : https://gitlab.bilendi.net/dev/ddi/-/commit/c9faced6b783c23fc0d99a0c4ea846506438c4eb
* résultat des/du TU ddi sur ces chgt ok : {{collapse()
&lt;pre&gt;
/usr/bin/php /home/parallels/dev/apps/ddi/vendor/phpunit/phpunit/phpunit --configuration /home/parallels/dev/apps/ddi/phpunit.xml.dist --filter Tests\\AppBundle\\Command\\Cron\\ValidatedDeclarationExtractCommandTest --test-suffix ValidatedDeclarationExtractCommandTest.php /home/parallels/dev/apps/ddi/tests/AppBundle/Command/Cron --teamcity
Testing started at 2:22 AM ...
PHPUnit 9.5.5 by Sebastian Bergmann and contributors.

Warning:       Your XML configuration validates against a deprecated schema.
Suggestion:    Migrate your XML configuration using "--migrate-configuration"!



Time: 00:05.807, Memory: 71.00 MB

OK (1 test, 3 assertions)

Remaining deprecation notices (61)

  9x: Bundle inheritance is deprecated as of 3.4 and will be removed in 4.0.
    6x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    3x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Import\DirectorCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\IntegrityCheckerCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "FOS\JsRoutingBundle\Command\RouterDebugExposedCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "FOS\JsRoutingBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "JMS\TranslationBundle\Command\ResourcesListCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "JMS\TranslationBundle\Command\ExtractTranslationCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Util\DatabaseNameCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Import\RegionalDirectorateDepartmentCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Import\AccountPointsCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\AllMultiProductDeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\ValidEarnMemberReachedTheirQuotasCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "AppBundle\Command\Cron\DeclarationExtractCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\NewEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\SendEmailCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\SwiftmailerBundle\Command\DebugCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Symfony\Bundle\AsseticBundle\Command\WatchCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\DumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Auto-registration of the command "Nelmio\ApiDocBundle\Command\SwaggerDumpCommand" is deprecated since Symfony 3.4 and won't be supported in 4.0. Use PSR-4 based service discovery instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: getEntityManager is deprecated since Symfony 2.1. Use getManager instead
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  2x: Symfony\Bundle\FrameworkBundle\Command\RouterDebugCommand::__construct() expects an instance of "Symfony\Component\Routing\RouterInterface" as first argument since Symfony 3.4. Not passing it is deprecated and will throw a TypeError in 4.0.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

  1x: Calling Doctrine\ORM\EntityManager::flush() with any arguments to flush specific entities is deprecated and will not be supported in Doctrine ORM 3.0.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The "Doctrine\Common\Inflector\Inflector::classify" method is deprecated and will be dropped in doctrine/inflector 2.0. Please update to the new Inflector API.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the KERNEL_DIR environment variable or the automatic guessing based on the phpunit.xml / phpunit.xml.dist file location is deprecated since Symfony 3.4. Set the KERNEL_CLASS environment variable to the fully-qualified class name of your Kernel instead. Not setting the KERNEL_CLASS environment variable will throw an exception on 4.0 unless you override the :createKernel() or :getKernelClass() method.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Autowiring services based on the types they implement is deprecated since Symfony 3.3 and won't be supported in version 4.0. Try changing the type-hint for argument "$earnManager" of method "Tests\DataFixtures\ORM\LoadEarnData::__construct()" to "Bilendi\EarningBundle\EarnManagerInterface" instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_BaseNodeVisitor" class is deprecated since Twig version 2.7, use "Twig\NodeVisitor\AbstractNodeVisitor" instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Using the "Twig_RuntimeLoaderInterface" class is deprecated since Twig version 2.7, use "Twig\RuntimeLoader\RuntimeLoaderInterface" instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The Symfony\Component\ClassLoader\ClassLoader class is deprecated since Symfony 3.3 and will be removed in 4.0. Use Composer instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "form_login" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: Listener "guard" on firewall "ws" has no "provider" set but multiple providers exist. Using the first configured provider (sso_provider) is deprecated since Symfony 3.4 and will throw an exception in 4.0, set the "provider" key on the firewall instead.
    1x in ValidatedDeclarationExtractCommandTest::setUp from Tests\AppBundle\Command\Cron

  1x: The "app.file.export.ftp" service is private, getting it from the container is deprecated since Symfony 3.2 and will fail in 4.0. You should either make the service public, or stop using the container directly and use dependency injection instead.
    1x in ValidatedDeclarationExtractCommandTest::testCommand from Tests\AppBundle\Command\Cron

Process finished with exit code 1

&lt;/pre&gt;
}}
** _les deprecated sf4 seront traitées dans le cadre de la migration sf4_

la met de ce chgt est à venir...</notes>
  <created_on>2021-06-17T10:21:12Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640072">
  <user id="529" name="Franck D."/>
  <notes>MET DONE NOW (content : needed changes to be compliant with the future symfony 4 migration)</notes>
  <created_on>2021-06-17T10:31:21Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="status_id">
      <old_value>2</old_value>
      <new_value>8</new_value>
    </detail>
    <detail property="attr" name="assigned_to_id">
      <old_value>355</old_value>
      <new_value>441</new_value>
    </detail>
  </details>
</journal>
<journal id="640075">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-17T10:49:54Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocked">
      <old_value/>
      <new_value>68520</new_value>
    </detail>
  </details>
</journal>
<journal id="640076">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-17T10:55:21Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attachment" name="99045">
      <old_value/>
      <new_value>Capture d’écran 2021-06-16 à 16.30.07.png</new_value>
    </detail>
    <detail property="attr" name="assigned_to_id">
      <old_value>441</old_value>
      <new_value>355</new_value>
    </detail>
  </details>
</journal>
<journal id="640078">
  <user id="529" name="Franck D."/>
  <notes>forget the previous note with a black screenshot =&gt; redmine bug.

After planning meeting, this tkt is set as blocked by the ddi sf4 migration tkt as it has been stated during this meeting that ddi requested delay for testing this tkt is up to august, whereas the expected sf4 migration delay is july, so if those delay are respected, then code of this tkt will have to be migrated to sf 4 before being pushed in production.
If ever the expected delays above wouldn't be respected then, one may remove this blocking link between both tickets, depending on the up to date (forecasted) delays.
Note : this is a "PROD" blocking, as this tkt is pushed in testing (still in symfony 3), for ddi test from now to august.
Once validated by ddi, this tkt can be safely tested for non technical regressions after its migration to sf 4 and mep.</notes>
  <created_on>2021-06-17T11:02:20Z</created_on>
  <private_notes>false</private_notes>
  <details type="array"/>
</journal>
<journal id="640341">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:34:03Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="relates">
      <old_value>67188</old_value>
      <new_value/>
    </detail>
  </details>
</journal>
<journal id="640343">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:34:13Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocks">
      <old_value/>
      <new_value>67188</new_value>
    </detail>
  </details>
</journal>
<journal id="640360">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T16:43:23Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>lire : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
    <detail property="attr" name="description">
      <old_value>[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement

{{collapse()

https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640361">
  <user id="529" name="Franck D."/>
  <notes>Déscription dans la procédure de déploiement des spécificité de gestion de la branche du tkt #67188 : dev/test/commit/push/review/met.
Ajout de notif aux dev/leads des ces spécificités.</notes>
  <created_on>2021-06-18T16:43:23Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640362">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T16:44:51Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement

{{collapse()

https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

}}</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

[DDI] souhaite un export des déclarations dont le gain est utilisable dans le eShop. 

Le programme VIP comporte la règle métier suivante, les points acquis suite à la déclaration sont pending jusqu'à atteindre le seuil de *300 europoints ou 8 générateurs* sur le programme en cours.


Chiffrage attendu : 
- export comportant toutes les déclarations dont la date "date gain" = date de la veille donc faire un lien entre la table [déclarations] et la table [gains].  Ainsi ne seront exportés que les déclarations dont le gain donne le droit à des points 'utilisables' donc &lt;&gt; gains.valid = 'A' 
- Débrancher la cron existante

_NB les 2 systèmes cohabiteront pendant 6 mois, car la mep est attendue pour juillet mais ne sera réellement exploitée qu'en janvier 2021. Il faudra donc chiffrer le débranchement de la cron actuelle dans l'évaluation._


Par exemple pour un VIP données :
+1. Basé sur les points+
Lundi : 150 points -&gt; pas dans le fichier
mardi : 140 points -&gt; pas dans le fichier
mercredi : 20 points -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 300 europoints est franchi (les points ne sont plus pending).

+2. Basé sur le nombre de générateurs si &lt; 300 europoints+
Lundi : 1 générateur -&gt; pas dans le fichier
mardi : 6 générateurs -&gt; pas dans le fichier
mercredi : 2 générateurs -&gt; Déclarations de lundi + mardi + mercredi dans le fichier généré dans la nuit de mercredi à jeudi car le seuil de 8 générateurs est franchi (les points ne sont plus pending).


Dépôt sur le SFTP  (SFTP client info dans le ticket parent)
Prod :
/SAP/Déclarations
Testing:
/SAP/Déclarations

Export :
Fréquence quotidienne
Format : Le fichier CSV séparateur ";"
Nommage : en attente du format avec notion de jour mois année

----

h1. Dev notes

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h2. Procédure de déploiement



Lire : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
  </details>
</journal>
<journal id="640363">
  <user id="529" name="Franck D."/>
  <notes>correction mineure</notes>
  <created_on>2021-06-18T16:44:51Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640365">
  <user id="529" name="Franck D."/>
  <notes>nouvelle met (purement de réorg de gestion de branche/code avec #67188) faite aujourd'hui : cf https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</notes>
  <created_on>2021-06-18T16:57:20Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640370">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:09:37Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>lire : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640372">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:10:19Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE : https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640378">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:12:26Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON :
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640379">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:12:52Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON :
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETE
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834

Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/827

CRON :
php bin/console app:cron:validated-declaration-extract (a brancher quotidiennement)

paramètres a configurer selon l'env. Les valeurs par défaut dev/testing. Valeurs de prod cf ticket parent:
ddi_sftp_host
ddi_sftp_login
ddi_sftp_password

OBSOLETES :
Branche et MR avec les correctifs pour les TU en local
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/834
Branche et MR avec les correctifs pour phpstan
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/835</new_value>
    </detail>
  </details>
</journal>
<journal id="640599">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T16:19:56Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocks">
      <old_value/>
      <new_value>65191</new_value>
    </detail>
  </details>
</journal></issue_66686>
<issue_66685>
<issue_url>https://redmine.bilendi.com/issues/66685</issue_url>
<journal id="640339">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T15:31:01Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*
2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value/>
      <new_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
  </details>
</journal>
<journal id="640340">
  <user id="529" name="Franck D."/>
  <notes>ajout branche ds les tech infos et lien vers le procédure deploiement décrivant les action de deploy spécifiques pour les sous tkt de ce tkt</notes>
  <created_on>2021-06-18T15:31:01Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640359">
  <user id="529" name="Franck D."/>
  <notes>Déscription dans la procédure de déploiement des spécificité de gestion de la branche du tkt #67188 : dev/test/commit/push/review/met.
Ajout de notif aux dev/leads des ces spécificités.</notes>
  <created_on>2021-06-18T16:39:57Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</old_value>
      <new_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire  en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._

}}</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</old_value>
      <new_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
deploy spécifique :
 voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</new_value>
    </detail>
  </details>
</journal>
<journal id="640367">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:07:28Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

*@dev,@leads : avant toute action de dev/test/commit/push/review/met sur ce tkt : lire https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement*

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire  en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._

}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</new_value>
    </detail>
    <detail property="cf" name="16">
      <old_value>https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685
deploy spécifique :
 voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement</old_value>
      <new_value>voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640368">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:08:15Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>voir https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640369">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:08:36Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843
branch :

https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640371">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:10:01Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640381">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-18T17:13:47Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="cf" name="16">
      <old_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

mr :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</old_value>
      <new_value>LIRE :
https://redmine.bilendi.com/issues/66685#Proc%C3%A9dure-de-d%C3%A9ploiement

MR :
https://gitlab.bilendi.net/dev/ddi/-/merge_requests/843

branch :
https://gitlab.bilendi.net/dev/ddi/-/commits/issue-66685</new_value>
    </detail>
  </details>
</journal>
<journal id="640389">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T06:36:10Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640390">
  <user id="529" name="Franck D."/>
  <notes>recopie de la proc de deploy après mauvaise manip redmine l'ayant supprimée...</notes>
  <created_on>2021-06-21T06:36:10Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640391">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-21T06:44:15Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685.
* la mep de issue-67188 suit le même principe.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne pas dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que ces TU des deux branches intégrées ainsi passent, vu que le code de l'une dépend de l'autre;
* la mep de issue-67188 suit le même principe que sa met.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640392">
  <user id="529" name="Franck D."/>
  <notes>quelques correc et ajout de précision dans le procédure de deploy.</notes>
  <created_on>2021-06-21T06:44:15Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640393">
  <user id="529" name="Franck D."/>
  <notes>NB : la valeur du champ estimation ne prend pas en compte les évol successives demandées par le client après sa demande initiale.</notes>
  <created_on>2021-06-21T06:46:57Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640603">
  <user id="529" name="Franck D."/>
  <notes>Ajout de la nouvelle branche issue-65191_v2 dans la section "procedure de déploiement" car elle suit le même spécificités de gestion que issue-67188.</notes>
  <created_on>2021-06-21T16:38:03Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Le tkt #67188 est mis en "bloqué par" #66686, car son code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces deux tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 d'autre part, et ne pas dupliquer les commit du premier dans le deuxième avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branche respective est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* la branche issue-67188 ne contient que les chgt de code spécifiques à #67188 donc :
** elle n'est pas exécutable dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de ses chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188, et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188;
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188;
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que cette branche n'est pas exécutable =&gt; elle n'est là que pour l'historisation des chgt spécifiques #67188 =&gt; pas de merge de master nécessaire à date dans cette branche, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 :
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188 dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que ces TU des deux branches intégrées ainsi passent, vu que le code de l'une dépend de l'autre;
* la mep de issue-67188 suit le même principe que sa met.

_NB : la branche obsolete issue-67188_from_issue-66686 doit être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640644">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-22T07:49:06Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard;
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard, mais doit être systématiquement mergée dans issue-66685, et metée ou mepée via la met/mep de issue-66685, afin de gérer les résolution de conflit potentiel avec les deux autres branches issue-67188 et issue-65191 :
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640645">
  <user id="529" name="Franck D."/>
  <notes>petite correction de la procédure de deploy concernant la gestion de la branche de #66686.</notes>
  <created_on>2021-06-22T07:49:06Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640660">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-22T09:26:21Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="attr" name="description">
      <old_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard, mais doit être systématiquement mergée dans issue-66685, et metée ou mepée via la met/mep de issue-66685, afin de gérer les résolution de conflit potentiel avec les deux autres branches issue-67188 et issue-65191 :
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686 (mais celle-ci merge master, donc lire en base sa séquence de commit "ref #66686");
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</old_value>
      <new_value>{{ToC}}

h1. Demande du demandeur

DDI prévoit une refonte de certains de flux existant de [BLD] -&gt; [DDI]

Le périmètre se découpe ainsi :

*1 - Modification de l'existant* 
1.1 - Déclarations des installateurs exclure les pending déclarations des VIP n'ayant pas encore atteint le seuil 300 points ou 8 générateurs (#66686)

*2 - Ajout de flux*

2.1 - Double Export de tous les mouvements de points (crédit / Débit) avec notion d'expiration (#67188)
2.2 - Export des commandes eShop (#65191)

Test
sftp.tst.bdrtg.net
bilenditst
Mot de passe de test : F6DiwRkchvgDuR*rCG!SC7rGHnBGVd9E
port : 22

Production
sftp.prd.bdrtg.net
bilendiprd
Mot de passe de production : Nxi2GRQsPU3&amp;f&amp;Gr7M49mbKur!MNhYH6
port : 22

----

h1. Dev notes

This section has been created with "this template":https://wiki.bilendi.net/doku.php/referentiel_de_pratiques:template_de_contenu#template_de_notes_de_dev

h2. Procédure de déploiement

{{collapse()

Les tkt #67188 et #65191 sont mis en "bloqué par" #66686, car leur code dépend d'élément de code créés (et gérés) dans la branche de #66686;
d'autre part afin de structurer la gestion des changement de ces trois tkt, de sorte que l'on puisse clairement identifier les chgt de code de #66686 d'une part, et les chgt de code spécifiques à #67188 et #65191 d'autre part, et ne pas dupliquer les commit du premier dans les deux autres avec les effet de complexité de gestion de branche que cela peut induire, la gestion de leur branches respectives est faite comme ceux-ci :
* la branche issue-66686 se gère via le process standard, mais doit être systématiquement mergée dans issue-66685, et metée ou mepée via la met/mep de issue-66685, afin de gérer les résolution de conflit potentiel avec les deux autres branches issue-67188 et issue-65191 :
* les branches issue-67188 et issue-65191 ne contiennent que les chgt de code spécifiques à leur tkt, donc :
** elle ne sont pas exécutables dans un clone sans que le code de #66686 y soit présent;
** pour pouvoir faire une lecture intègre et comprendre la logique de leur chgt (en review par ex), il faut d'abord lire les chgt de #66686;
* le principe spécifique de dev/test/commit/push/met de #67188 et #65191 est donc le suivant :
* développer/tester/commiter/pusher/meter les chgt de #66686 d'abord (s'il y en a);
* merger ces chgt dans la branche issue-66685 (cf tech infos);
* dev/tester les chgt spécifiques à #67188 (et/ou #65191), dans cette branche, puis lorsqu'ils sont terminés, les commiter dans issue-67188 (et/ou issue-65191_v2), et non dans issue-66685, en faisant les actions spécifiques suivantes :
** git stash de ces chgt;
** git checkout de issue-67188(et/ou issue-65191_v2);
** puis git stash pop, pour récup les chgt dans le working tree de issue-67188(et/ou issue-65191_v2);
** puis git commit --no-verify pour les commiter en disablant les hook de pré-commit (ils planteront vu que ces branches ne sont pas exécutables =&gt; elles ne sont là que pour l'historisation des chgt spécifiques à leur tkt =&gt; pas de merge de master nécessaire à date dans ces branches, qui sont fait aujourd'hui dans #66686);
** puis git push de cette branche;
* pour met issue-67188 (et/ou issue-65191_v2):
** merger l'éventuelle nouvelle version de issue-66686 dans issue-66685;
** merger issue-67188(et/ou issue-65191_v2) dans issue-66685;
** lancer les TU et s'ils passent, pusher puis meter issue-66685;
*** il est pertinent de vérifier que les TU des trois branches intégrées ainsi passent, vu que les chgt code des unes peut théoriquement impacter les autres, et donc la vérif de non régression des ces chgt de manière intégrée est plus safe (et guère plus couteuse);
* la mep de issue-67188(et/ou issue-65191_v2) suit le même principe que sa met.

_NB : les branches obsolete issue-67188_from_issue-66686 et issue-65191 doivent être supprimées suite à la mep de ces tkt._


}}</new_value>
    </detail>
  </details>
</journal>
<journal id="640661">
  <user id="529" name="Franck D."/>
  <notes>petite correction de la section procédure de déploiement après re-vérif des merge request des trois sous tkt...</notes>
  <created_on>2021-06-22T09:26:21Z</created_on>
  <private_notes>true</private_notes>
  <details type="array"/>
</journal>
<journal id="640670">
  <user id="529" name="Franck D."/>
  <notes/>
  <created_on>2021-06-22T09:44:59Z</created_on>
  <private_notes>false</private_notes>
  <details type="array">
    <detail property="relation" name="blocks">
      <old_value/>
      <new_value>68520</new_value>
    </detail>
  </details>
</journal></issue_66685>
<issue_66633>
<issue_url>https://redmine.bilendi.com/issues/66633</issue_url>
</issue_66633>
<issue_66620>
<issue_url>https://redmine.bilendi.com/issues/66620</issue_url>
</issue_66620>
<issue_66619>
<issue_url>https://redmine.bilendi.com/issues/66619</issue_url>
</issue_66619>
<issue_66617>
<issue_url>https://redmine.bilendi.com/issues/66617</issue_url>
</issue_66617>
<issue_66613>
<issue_url>https://redmine.bilendi.com/issues/66613</issue_url>
</issue_66613>
<issue_66532>
<issue_url>https://redmine.bilendi.com/issues/66532</issue_url>
</issue_66532>
<issue_66528>
<issue_url>https://redmine.bilendi.com/issues/66528</issue_url>
</issue_66528>
<issue_66517>
<issue_url>https://redmine.bilendi.com/issues/66517</issue_url>
</issue_66517>
<issue_66486>
<issue_url>https://redmine.bilendi.com/issues/66486</issue_url>
</issue_66486>
<issue_66452>
<issue_url>https://redmine.bilendi.com/issues/66452</issue_url>
</issue_66452>
<issue_66388>
<issue_url>https://redmine.bilendi.com/issues/66388</issue_url>
</issue_66388>
<issue_66380>
<issue_url>https://redmine.bilendi.com/issues/66380</issue_url>
</issue_66380>
<issue_66326>
<issue_url>https://redmine.bilendi.com/issues/66326</issue_url>
</issue_66326>
<issue_66317>
<issue_url>https://redmine.bilendi.com/issues/66317</issue_url>
</issue_66317>
<issue_66316>
<issue_url>https://redmine.bilendi.com/issues/66316</issue_url>
</issue_66316>
<issue_66315>
<issue_url>https://redmine.bilendi.com/issues/66315</issue_url>
</issue_66315>
<issue_66314>
<issue_url>https://redmine.bilendi.com/issues/66314</issue_url>
</issue_66314>
<issue_66312>
<issue_url>https://redmine.bilendi.com/issues/66312</issue_url>
</issue_66312>
<issue_66308>
<issue_url>https://redmine.bilendi.com/issues/66308</issue_url>
</issue_66308>
</journals>
